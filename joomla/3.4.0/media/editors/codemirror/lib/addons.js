(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineOption("fullScreen",false,function(d,f,e){if(e==a.Init){e=false}if(!e==!f){return}if(f){b(d)}else{c(d)}});function b(d){var e=d.getWrapperElement();d.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:e.style.width,height:e.style.height};e.style.width="";e.style.height="auto";e.className+=" CodeMirror-fullscreen";document.documentElement.style.overflow="hidden";d.refresh()}function c(d){var e=d.getWrapperElement();e.className=e.className.replace(/\s*CodeMirror-fullscreen\b/,"");document.documentElement.style.overflow="";var f=d.state.fullScreenRestore;e.style.width=f.width;e.style.height=f.height;window.scrollTo(f.scrollLeft,f.scrollTop);d.refresh()}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineExtension("addPanel",function(g,f){if(!this.state.panels){b(this)}var h=this.state.panels;if(f&&f.position=="bottom"){h.wrapper.appendChild(g)}else{h.wrapper.insertBefore(g,h.wrapper.firstChild)}var e=(f&&f.height)||g.offsetHeight;this._setSize(null,h.heightLeft-=e);h.panels++;return new d(this,g,f,e)});function d(f,h,g,e){this.cm=f;this.node=h;this.options=g;this.height=e;this.cleared=false}d.prototype.clear=function(){if(this.cleared){return}this.cleared=true;var e=this.cm.state.panels;this.cm._setSize(null,e.heightLeft+=this.height);e.wrapper.removeChild(this.node);if(--e.panels==0){c(this.cm)}};d.prototype.changed=function(e){var f=e==null?this.node.offsetHeight:e;var g=this.cm.state.panels;this.cm._setSize(null,g.height+=(f-this.height));this.height=f};function b(f){var h=f.getWrapperElement();var g=window.getComputedStyle?window.getComputedStyle(h):h.currentStyle;var e=parseInt(g.height);var i=f.state.panels={setHeight:h.style.height,heightLeft:e,panels:0,wrapper:document.createElement("div")};h.parentNode.insertBefore(i.wrapper,h);var j=f.hasFocus();i.wrapper.appendChild(h);if(j){f.focus()}f._setSize=f.setSize;if(e!=null){f.setSize=function(m,k){if(k==null){return this._setSize(m,k)}i.setHeight=k;if(typeof k!="number"){var l=/^(\d+\.?\d*)px$/.exec(k);if(l){k=Number(l[1])}else{i.wrapper.style.height=k;k=i.wrapper.offsetHeight;i.wrapper.style.height=""}}f._setSize(m,i.heightLeft+=(k-e));e=k}}}function c(e){var g=e.state.panels;e.state.panels=null;var f=e.getWrapperElement();g.wrapper.parentNode.replaceChild(f,g.wrapper);f.style.height=g.setHeight;e.setSize=e._setSize;e.setSize()}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var h="()[]{}''\"\"";var g="[]{}";var i=/\s/;var f=c.Pos;c.defineOption("autoCloseBrackets",false,function(j,o,k){if(k!=c.Init&&k){j.removeKeyMap("autoCloseBrackets")}if(!o){return}var m=h,l=g;if(typeof o=="string"){m=o}else{if(typeof o=="object"){if(o.pairs!=null){m=o.pairs}if(o.explode!=null){l=o.explode}}}var n=b(m);if(l){n.Enter=a(l)}j.addKeyMap(n)});function d(j,l){var k=j.getRange(f(l.line,l.ch-1),f(l.line,l.ch+1));return k.length==2?k:null}function e(j,p,n){var k=j.getLine(p.line);var m=j.getTokenAt(p);if(/\bstring2?\b/.test(m.type)){return false}var o=new c.StringStream(k.slice(0,p.ch)+n+k.slice(p.ch),4);o.pos=o.start=m.start;for(;;){var l=j.getMode().token(o,m.state);if(o.pos>=p.ch+1){return/\bstring2?\b/.test(l)}o.start=o.pos}}function b(l){var m={name:"autoCloseBrackets",Backspace:function(n){if(n.getOption("disableInput")){return c.Pass}var o=n.listSelections();for(var p=0;p<o.length;p++){if(!o[p].empty()){return c.Pass}var q=d(n,o[p].head);if(!q||l.indexOf(q)%2!=0){return c.Pass}}for(var p=o.length-1;p>=0;p--){var r=o[p].head;n.replaceRange("",f(r.line,r.ch-1),f(r.line,r.ch+1))}}};var k="";for(var j=0;j<l.length;j+=2){(function(o,n){k+=n;m["'"+o+"'"]=function(p){if(p.getOption("disableInput")){return c.Pass}var q=p.listSelections(),v,u;for(var t=0;t<q.length;t++){var r=q[t],w=r.head,s;var u=p.getRange(w,f(w.line,w.ch+1));if(!r.empty()){s="surround"}else{if(o==n&&u==n){if(p.getRange(w,f(w.line,w.ch+3))==o+o+o){s="skipThree"}else{s="skip"}}else{if(o==n&&w.ch>1&&p.getRange(f(w.line,w.ch-2),w)==o+o&&(w.ch<=2||p.getRange(f(w.line,w.ch-3),f(w.line,w.ch-2))!=o)){s="addFour"}else{if(o=='"'||o=="'"){if(!c.isWordChar(u)&&e(p,w,o)){s="both"}else{return c.Pass}}else{if(p.getLine(w.line).length==w.ch||k.indexOf(u)>=0||i.test(u)){s="both"}else{return c.Pass}}}}}if(!v){v=s}else{if(v!=s){return c.Pass}}}p.operation(function(){if(v=="skip"){p.execCommand("goCharRight")}else{if(v=="skipThree"){for(var y=0;y<3;y++){p.execCommand("goCharRight")}}else{if(v=="surround"){var x=p.getSelections();for(var y=0;y<x.length;y++){x[y]=o+x[y]+n}p.replaceSelections(x,"around")}else{if(v=="both"){p.replaceSelection(o+n,null);p.execCommand("goCharLeft")}else{if(v=="addFour"){p.replaceSelection(o+o+o+o,"before");p.execCommand("goCharRight")}}}}}})};if(o!=n){m["'"+n+"'"]=function(p){var q=p.listSelections();for(var s=0;s<q.length;s++){var r=q[s];if(!r.empty()||p.getRange(r.head,f(r.head.line,r.head.ch+1))!=n){return c.Pass}}p.execCommand("goCharRight")}}})(l.charAt(j),l.charAt(j+1))}return m}function a(j){return function(k){if(k.getOption("disableInput")){return c.Pass}var l=k.listSelections();for(var m=0;m<l.length;m++){if(!l[m].empty()){return c.Pass}var n=d(k,l[m].head);if(!n||j.indexOf(n)%2!=0){return c.Pass}}k.operation(function(){k.replaceSelection("\n\n",null);k.execCommand("goCharLeft");l=k.listSelections();for(var p=0;p<l.length;p++){var o=l[p].head.line;k.indentLine(o,null,true);k.indentLine(o+1,null,true)}})}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../fold/xml-fold"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../fold/xml-fold"],a)}else{a(CodeMirror)}}})(function(b){b.defineOption("autoCloseTags",false,function(i,l,j){if(j!=b.Init&&j){i.removeKeyMap("autoCloseTags")}if(!l){return}var k={name:"autoCloseTags"};if(typeof l!="object"||l.whenClosing){k["'/'"]=function(m){return e(m)}}if(typeof l!="object"||l.whenOpening){k["'>'"]=function(m){return a(m)}}i.addKeyMap(k)});var d=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var c=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];function a(x){if(x.getOption("disableInput")){return b.Pass}var k=x.listSelections(),r=[];for(var s=0;s<k.length;s++){if(!k[s].empty()){return b.Pass}var w=k[s].head,y=x.getTokenAt(w);var z=b.innerMode(x.getMode(),y.state),j=z.state;if(z.mode.name!="xml"||!j.tagName){return b.Pass}var l=x.getOption("autoCloseTags"),t=z.mode.configuration=="html";var n=(typeof l=="object"&&l.dontCloseTags)||(t&&d);var v=(typeof l=="object"&&l.indentTags)||(t&&c);var q=j.tagName;if(y.end>w.ch){q=q.slice(0,q.length-y.end+w.ch)}var u=q.toLowerCase();if(!q||y.type=="string"&&(y.end!=w.ch||!/[\"\']/.test(y.string.charAt(y.string.length-1))||y.string.length==1)||y.type=="tag"&&j.type=="closeTag"||y.string.indexOf("/")==(y.string.length-1)||n&&g(n,u)>-1||f(x,q,w,j,true)){return b.Pass}var p=v&&g(v,u)>-1;r[s]={indent:p,text:">"+(p?"\n\n":"")+"</"+q+">",newPos:p?b.Pos(w.line+1,0):b.Pos(w.line,w.ch+1)}}for(var s=k.length-1;s>=0;s--){var o=r[s];x.replaceRange(o.text,k[s].head,k[s].anchor,"+insert");var m=x.listSelections().slice(0);m[s]={head:o.newPos,anchor:o.newPos};x.setSelections(m);if(o.indent){x.indentLine(o.newPos.line,null,true);x.indentLine(o.newPos.line+1,null,true)}}}function h(q,m){var k=q.listSelections(),l=[];var p=m?"/":"</";for(var n=0;n<k.length;n++){if(!k[n].empty()){return b.Pass}var o=k[n].head,r=q.getTokenAt(o);var s=b.innerMode(q.getMode(),r.state),j=s.state;if(m&&(r.type=="string"||r.string.charAt(0)!="<"||r.start!=o.ch-1)){return b.Pass}if(s.mode.name!="xml"){if(q.getMode().name=="htmlmixed"&&s.mode.name=="javascript"){l[n]=p+"script>"}else{if(q.getMode().name=="htmlmixed"&&s.mode.name=="css"){l[n]=p+"style>"}else{return b.Pass}}}else{if(!j.context||!j.context.tagName||f(q,j.context.tagName,o,j)){return b.Pass}l[n]=p+j.context.tagName+">"}}q.replaceSelections(l);k=q.listSelections();for(var n=0;n<k.length;n++){if(n==k.length-1||k[n].head.line<k[n+1].head.line){q.indentLine(k[n].head.line)}}}function e(i){if(i.getOption("disableInput")){return b.Pass}h(i,true)}b.commands.closeTag=function(i){return h(i)};function g(m,j){if(m.indexOf){return m.indexOf(j)}for(var k=0,l=m.length;k<l;++k){if(m[k]==j){return k}}return -1}function f(r,k,q,j,t){if(!b.scanForClosingTag){return false}var l=Math.min(r.lastLine()+1,q.line+500);var s=b.scanForClosingTag(r,q,null,l);if(!s||s.tag!=k){return false}var m=j.context;for(var o=t?1:0;m&&m.tagName==k;m=m.prev){++o}q=s.to;for(var n=1;n<o;n++){var p=b.scanForClosingTag(r,q,null,l);if(!p||p.tag!=k){return false}q=p.to}return true}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(e){var d=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var i=e.Pos;var a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function f(q,m,p,k){var s=q.getLineHandle(m.line),o=m.ch-1;var n=(o>=0&&a[s.text.charAt(o)])||a[s.text.charAt(++o)];if(!n){return null}var l=n.charAt(1)==">"?1:-1;if(p&&(l>0)!=(o==m.ch)){return null}var j=q.getTokenTypeAt(i(m.line,o+1));var r=g(q,i(m.line,o+(l>0?1:0)),l,j||null,k);if(r==null){return null}return{from:i(m.line,o),to:r&&r.pos,match:r&&r.ch==n.charAt(0),forward:l>0}}function g(w,r,n,k,m){var l=(m&&m.maxScanLineLength)||10000;var t=(m&&m.maxScanLines)||1000;var v=[];var x=m&&m.bracketRegex?m.bracketRegex:/[(){}[\]]/;var q=n>0?Math.min(r.line+t,w.lastLine()+1):Math.max(w.firstLine()-1,r.line-t);for(var o=r.line;o!=q;o+=n){var y=w.getLine(o);if(!y){continue}var u=n>0?0:y.length-1,p=n>0?y.length:-1;if(y.length>l){continue}if(o==r.line){u=r.ch-(n<0?1:0)}for(;u!=p;u+=n){var j=y.charAt(u);if(x.test(j)&&(k===undefined||w.getTokenTypeAt(i(o,u+1))==k)){var s=a[j];if((s.charAt(1)==">")==(n>0)){v.push(j)}else{if(!v.length){return{pos:i(o,u),ch:j}}else{v.pop()}}}}}return o-n==(n>0?w.lastLine():w.firstLine())?false:null}function b(s,n,m){var k=s.state.matchBrackets.maxHighlightLineLength||1000;var r=[],l=s.listSelections();for(var o=0;o<l.length;o++){var q=l[o].empty()&&f(s,l[o].head,false,m);if(q&&s.getLine(q.from.line).length<=k){var j=q.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";r.push(s.markText(q.from,i(q.from.line,q.from.ch+1),{className:j}));if(q.to&&s.getLine(q.to.line).length<=k){r.push(s.markText(q.to,i(q.to.line,q.to.ch+1),{className:j}))}}}if(r.length){if(d&&s.state.focused){s.display.input.focus()}var p=function(){s.operation(function(){for(var t=0;t<r.length;t++){r[t].clear()}})};if(n){setTimeout(p,800)}else{return p}}}var c=null;function h(j){j.operation(function(){if(c){c();c=null}c=b(j,false,j.state.matchBrackets)})}e.defineOption("matchBrackets",false,function(j,l,k){if(k&&k!=e.Init){j.off("cursorActivity",h)}if(l){j.state.matchBrackets=typeof l=="object"?l:{};j.on("cursorActivity",h)}});e.defineExtension("matchBrackets",function(){b(this,true)});e.defineExtension("findMatchingBracket",function(l,j,k){return f(this,l,j,k)});e.defineExtension("scanForBracket",function(m,k,l,j){return g(this,m,k,l,j)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../fold/xml-fold"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../fold/xml-fold"],a)}else{a(CodeMirror)}}})(function(c){c.defineOption("matchTags",false,function(e,g,f){if(f&&f!=c.Init){e.off("cursorActivity",b);e.off("viewportChange",d);a(e)}if(g){e.state.matchBothTags=typeof g=="object"&&g.bothTags;e.on("cursorActivity",b);e.on("viewportChange",d);b(e)}});function a(e){if(e.state.tagHit){e.state.tagHit.clear()}if(e.state.tagOther){e.state.tagOther.clear()}e.state.tagHit=e.state.tagOther=null}function b(e){e.state.failedTagMatch=false;e.operation(function(){a(e);if(e.somethingSelected()){return}var j=e.getCursor(),g=e.getViewport();g.from=Math.min(g.from,j.line);g.to=Math.max(j.line+1,g.to);var h=c.findMatchingTag(e,j,g);if(!h){return}if(e.state.matchBothTags){var i=h.at=="open"?h.open:h.close;if(i){e.state.tagHit=e.markText(i.from,i.to,{className:"CodeMirror-matchingtag"})}}var f=h.at=="close"?h.open:h.close;if(f){e.state.tagOther=e.markText(f.from,f.to,{className:"CodeMirror-matchingtag"})}else{e.state.failedTagMatch=true}})}function d(e){if(e.state.failedTagMatch){b(e)}}c.commands.toMatchingTag=function(f){var g=c.findMatchingTag(f,f.getCursor());if(g){var e=g.at=="close"?g.open:g.close;if(e){f.extendSelection(e.to,e.from)}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerHelper("fold","brace",function(m,h){var o=h.line,g=m.getLine(o);var n,t;function d(u){for(var i=h.ch,v=0;;){var w=i<=0?-1:g.lastIndexOf(u,i-1);if(w==-1){if(v==1){break}v=1;i=g.length;continue}if(v==1&&w<h.ch){break}t=m.getTokenTypeAt(a.Pos(o,w+1));if(!/^(comment|string)/.test(t)){return w+1}i=w-1}}var j="{",e="}",n=d("{");if(n==null){j="[",e="]";n=d("[")}if(n==null){return}var l=1,c=m.lastLine(),f,q;outer:for(var s=o;s<=c;++s){var p=m.getLine(s),k=s==o?n:0;for(;;){var b=p.indexOf(j,k),r=p.indexOf(e,k);if(b<0){b=p.length}if(r<0){r=p.length}k=Math.min(b,r);if(k==p.length){break}if(m.getTokenTypeAt(a.Pos(s,k+1))==t){if(k==b){++l}else{if(!--l){f=s;q=k;break outer}}}++k}}if(f==null||o==f&&q==n){return}return{from:a.Pos(o,n),to:a.Pos(f,q)}});a.registerHelper("fold","import",function(b,h){function g(k){if(k<b.firstLine()||k>b.lastLine()){return null}var o=b.getTokenAt(a.Pos(k,1));if(!/\S/.test(o.string)){o=b.getTokenAt(a.Pos(k,o.end+1))}if(o.type!="keyword"||o.string!="import"){return null}for(var l=k,m=Math.min(b.lastLine(),k+10);l<=m;++l){var n=b.getLine(l),j=n.indexOf(";");if(j!=-1){return{startCh:o.end,end:a.Pos(l,j)}}}}var h=h.line,d=g(h),f;if(!d||g(h-1)||((f=g(h-2))&&f.end.line==h-1)){return null}for(var c=d.end;;){var e=g(c.line+1);if(e==null){break}c=e.end}return{from:b.clipPos(a.Pos(h,d.startCh+1)),to:c}});a.registerHelper("fold","include",function(b,g){function f(h){if(h<b.firstLine()||h>b.lastLine()){return null}var i=b.getTokenAt(a.Pos(h,1));if(!/\S/.test(i.string)){i=b.getTokenAt(a.Pos(h,i.end+1))}if(i.type=="meta"&&i.string.slice(0,8)=="#include"){return i.start+8}}var g=g.line,d=f(g);if(d==null||f(g-1)!=null){return null}for(var c=g;;){var e=f(c+1);if(e==null){break}++c}return{from:a.Pos(g,d+1),to:b.clipPos(a.Pos(c))}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function d(n,m,o,i){if(o&&o.call){var g=o;o=null}else{var g=c(n,o,"rangeFinder")}if(typeof m=="number"){m=b.Pos(m,0)}var h=c(n,o,"minFoldSize");function f(p){var q=g(n,m);if(!q||q.to.line-q.from.line<h){return null}var s=n.findMarksAt(q.from);for(var r=0;r<s.length;++r){if(s[r].__isFold&&i!=="fold"){if(!p){return null}q.cleared=true;s[r].clear()}}return q}var k=f(true);if(c(n,o,"scanUp")){while(!k&&m.line>n.firstLine()){m=b.Pos(m.line-1,0);k=f(false)}}if(!k||k.cleared||i==="unfold"){return}var l=e(n,o);b.on(l,"mousedown",function(p){j.clear();b.e_preventDefault(p)});var j=n.markText(k.from,k.to,{replacedWith:l,clearOnEnter:true,__isFold:true});j.on("clear",function(q,p){b.signal(n,"unfold",n,q,p)});b.signal(n,"fold",n,k.from,k.to)}function e(f,g){var h=c(f,g,"widget");if(typeof h=="string"){var i=document.createTextNode(h);h=document.createElement("span");h.appendChild(i);h.className="CodeMirror-foldmarker"}return h}b.newFoldFunction=function(g,f){return function(h,i){d(h,i,{rangeFinder:g,widget:f})}};b.defineExtension("foldCode",function(h,f,g){d(this,h,f,g)});b.defineExtension("isFolded",function(h){var g=this.findMarksAt(h);for(var f=0;f<g.length;++f){if(g[f].__isFold){return true}}});b.commands.toggleFold=function(f){f.foldCode(f.getCursor())};b.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold")};b.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold")};b.commands.foldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"fold")}})};b.commands.unfoldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"unfold")}})};b.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(g,k){for(var h=0;h<f.length;++h){var j=f[h](g,k);if(j){return j}}}});b.registerHelper("fold","auto",function(f,k){var h=f.getHelpers(k,"fold");for(var g=0;g<h.length;g++){var j=h[g](f,k);if(j){return j}}});var a={rangeFinder:b.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:false};b.defineOption("foldOptions",null);function c(f,h,g){if(h&&h[g]!==undefined){return h[g]}var i=f.options.foldOptions;if(i&&i[g]!==undefined){return i[g]}return a[g]}b.defineExtension("foldOption",function(g,f){return c(this,g,f)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("./foldcode"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","./foldcode"],a)}else{a(CodeMirror)}}})(function(d){d.defineOption("foldGutter",false,function(m,o,n){if(n&&n!=d.Init){m.clearGutter(m.state.foldGutter.options.gutter);m.state.foldGutter=null;m.off("gutterClick",k);m.off("change",g);m.off("viewportChange",l);m.off("fold",e);m.off("unfold",e);m.off("swapDoc",b)}if(o){m.state.foldGutter=new j(i(o));b(m);m.on("gutterClick",k);m.on("change",g);m.on("viewportChange",l);m.on("fold",e);m.on("unfold",e);m.on("swapDoc",b)}});var h=d.Pos;function j(m){this.options=m;this.from=this.to=0}function i(m){if(m===true){m={}}if(m.gutter==null){m.gutter="CodeMirror-foldgutter"}if(m.indicatorOpen==null){m.indicatorOpen="CodeMirror-foldgutter-open"}if(m.indicatorFolded==null){m.indicatorFolded="CodeMirror-foldgutter-folded"}return m}function c(m,n){var p=m.findMarksAt(h(n));for(var o=0;o<p.length;++o){if(p[o].__isFold&&p[o].find().from.line==n){return true}}}function f(m){if(typeof m=="string"){var n=document.createElement("div");n.className=m+" CodeMirror-guttermarker-subtle";return n}else{return m.cloneNode(true)}}function a(m,s,r){var o=m.state.foldGutter.options,q=s;var p=m.foldOption(o,"minFoldSize");var n=m.foldOption(o,"rangeFinder");m.eachLine(s,r,function(t){var w=null;if(c(m,q)){w=f(o.indicatorFolded)}else{var v=h(q,0);var u=n&&n(m,v);if(u&&u.to.line-u.from.line>=p){w=f(o.indicatorOpen)}}m.setGutterMarker(t,o.gutter,w);++q})}function b(m){var n=m.getViewport(),o=m.state.foldGutter;if(!o){return}m.operation(function(){a(m,n.from,n.to)});o.from=n.from;o.to=n.to}function k(m,n,p){var o=m.state.foldGutter.options;if(p!=o.gutter){return}m.foldCode(h(n,0),o.rangeFinder)}function g(m){var o=m.state.foldGutter,n=m.state.foldGutter.options;o.from=o.to=0;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){b(m)},n.foldOnChangeTimeSpan||600)}function l(m){var o=m.state.foldGutter,n=m.state.foldGutter.options;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){var p=m.getViewport();if(o.from==o.to||p.from-o.to>20||o.from-p.to>20){b(m)}else{m.operation(function(){if(p.from<o.from){a(m,p.from,o.from);o.from=p.from}if(p.to>o.to){a(m,o.to,p.to);o.to=p.to}})}},n.updateViewportTimeSpan||400)}function e(m,p){var o=m.state.foldGutter,n=p.line;if(n>=o.from&&n<o.to){a(m,n,n+1)}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(i){var m=i.Pos;function l(r,q){return r.line-q.line||r.ch-q.ch}var j="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD";var o=j+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040";var d=new RegExp("<(/?)(["+j+"]["+o+"]*)","g");function b(q,r,t,s){this.line=r;this.ch=t;this.cm=q;this.text=q.getLine(r);this.min=s?s.from:q.firstLine();this.max=s?s.to-1:q.lastLine()}function h(q,s){var r=q.cm.getTokenTypeAt(m(q.line,s));return r&&/\btag\b/.test(r)}function a(q){if(q.line>=q.max){return}q.ch=0;q.text=q.cm.getLine(++q.line);return true}function n(q){if(q.line<=q.min){return}q.text=q.cm.getLine(--q.line);q.ch=q.text.length;return true}function g(s){for(;;){var r=s.text.indexOf(">",s.ch);if(r==-1){if(a(s)){continue}else{return}}if(!h(s,r+1)){s.ch=r+1;continue}var q=s.text.lastIndexOf("/",r);var t=q>-1&&!/\S/.test(s.text.slice(q+1,r));s.ch=r+1;return t?"selfClose":"regular"}}function k(r){for(;;){var q=r.ch?r.text.lastIndexOf("<",r.ch-1):-1;if(q==-1){if(n(r)){continue}else{return}}if(!h(r,q+1)){r.ch=q;continue}d.lastIndex=q;r.ch=q;var s=d.exec(r.text);if(s&&s.index==q){return s}}}function p(q){for(;;){d.lastIndex=q.ch;var r=d.exec(q.text);if(!r){if(a(q)){continue}else{return}}if(!h(q,r.index+1)){q.ch=r.index+1;continue}q.ch=r.index+r[0].length;return r}}function e(s){for(;;){var r=s.ch?s.text.lastIndexOf(">",s.ch-1):-1;if(r==-1){if(n(s)){continue}else{return}}if(!h(s,r+1)){s.ch=r;continue}var q=s.text.lastIndexOf("/",r);var t=q>-1&&!/\S/.test(s.text.slice(q+1,r));s.ch=r+1;return t?"selfClose":"regular"}}function f(t,r){var q=[];for(;;){var v=p(t),s,x=t.line,w=t.ch-(v?v[0].length:0);if(!v||!(s=g(t))){return}if(s=="selfClose"){continue}if(v[1]){for(var u=q.length-1;u>=0;--u){if(q[u]==v[2]){q.length=u;break}}if(u<0&&(!r||r==v[2])){return{tag:v[2],from:m(x,w),to:m(t.line,t.ch)}}}else{q.push(v[2])}}}function c(s,r){var q=[];for(;;){var w=e(s);if(!w){return}if(w=="selfClose"){k(s);continue}var v=s.line,u=s.ch;var x=k(s);if(!x){return}if(x[1]){q.push(x[2])}else{for(var t=q.length-1;t>=0;--t){if(q[t]==x[2]){q.length=t;break}}if(t<0&&(!r||r==x[2])){return{tag:x[2],from:m(s.line,s.ch),to:m(v,u)}}}}}i.registerHelper("fold","xml",function(q,v){var s=new b(q,v.line,0);for(;;){var t=p(s),r;if(!t||s.line!=v.line||!(r=g(s))){return}if(!t[1]&&r!="selfClose"){var v=m(s.line,s.ch);var u=f(s,t[2]);return u&&{from:v,to:u.from}}}});i.findMatchingTag=function(q,x,t){var s=new b(q,x.line,x.ch,t);if(s.text.indexOf(">")==-1&&s.text.indexOf("<")==-1){return}var r=g(s),w=r&&m(s.line,s.ch);var v=r&&k(s);if(!r||!v||l(s,x)>0){return}var u={from:m(s.line,s.ch),to:w,tag:v[2]};if(r=="selfClose"){return{open:u,close:null,at:"open"}}if(v[1]){return{open:c(s,v[2]),close:u,at:"close"}}else{s=new b(q,w.line,w.ch,t);return{open:u,close:f(s,v[2]),at:"open"}}};i.findEnclosingTag=function(q,w,s){var r=new b(q,w.line,w.ch,s);for(;;){var u=c(r);if(!u){break}var t=new b(q,w.line,w.ch,s);var v=f(t,u.tag);if(v){return{open:u,close:v}}}};i.scanForClosingTag=function(q,u,t,s){var r=new b(q,u.line,u.ch,s?{from:0,to:s}:null);return f(r,t)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),"cjs")}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],function(b){a(b,"amd")})}else{a(CodeMirror,"plain")}}})(function(a,c){if(!a.modeURL){a.modeURL="../mode/%N/%N.js"}var e={};function d(f,h){var g=h;return function(){if(--g==0){f()}}}function b(l,f){var k=a.modes[l].dependencies;if(!k){return f()}var j=[];for(var h=0;h<k.length;++h){if(!a.modes.hasOwnProperty(k[h])){j.push(k[h])}}if(!j.length){return f()}var g=d(f,j.length);for(var h=0;h<j.length;++h){a.requireMode(j[h],g)}}a.requireMode=function(k,f){if(typeof k!="string"){k=k.name}if(a.modes.hasOwnProperty(k)){return b(k,f)}if(e.hasOwnProperty(k)){return e[k].push(f)}var h=a.modeURL.replace(/%N/g,k);if(c=="plain"){var g=document.createElement("script");g.src=h;var i=document.getElementsByTagName("script")[0];var j=e[k]=[f];a.on(g,"load",function(){b(k,function(){for(var l=0;l<j.length;++l){j[l]()}})});i.parentNode.insertBefore(g,i)}else{if(c=="cjs"){require(h);f()}else{if(c=="amd"){requirejs([h],f)}}}};a.autoLoadMode=function(f,g){if(!a.modes.hasOwnProperty(g)){a.requireMode(g,function(){f.setOption("mode",f.getOption("mode"))})}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.multiplexingMode=function(c){var e=Array.prototype.slice.call(arguments,1);var b=e.length;function d(g,h,i){if(typeof h=="string"){return g.indexOf(h,i)}var f=h.exec(i?g.slice(i):g);return f?f.index+i:-1}return{startState:function(){return{outer:a.startState(c),innerActive:null,inner:null}},copyState:function(f){return{outer:a.copyState(c,f.outer),innerActive:f.innerActive,inner:f.innerActive&&a.copyState(f.innerActive.mode,f.inner)}},token:function(o,f){if(!f.innerActive){var h=Infinity,m=o.string;for(var j=0;j<b;++j){var l=e[j];var p=d(m,l.open,o.pos);if(p==o.pos){o.match(l.open);f.innerActive=l;f.inner=a.startState(l.mode,c.indent?c.indent(f.outer,""):0);return l.delimStyle}else{if(p!=-1&&p<h){h=p}}}if(h!=Infinity){o.string=m.slice(0,h)}var g=c.token(o,f.outer);if(h!=Infinity){o.string=m}return g}else{var k=f.innerActive,m=o.string;if(!k.close&&o.sol()){f.innerActive=f.inner=null;return this.token(o,f)}var p=k.close?d(m,k.close,o.pos):-1;if(p==o.pos){o.match(k.close);f.innerActive=f.inner=null;return k.delimStyle}if(p>-1){o.string=m.slice(0,p)}var n=k.mode.token(o,f.inner);if(p>-1){o.string=m}if(k.innerStyle){if(n){n=n+" "+k.innerStyle}else{n=k.innerStyle}}return n}},indent:function(g,f){var h=g.innerActive?g.innerActive.mode:c;if(!h.indent){return a.Pass}return h.indent(g.innerActive?g.inner:g.outer,f)},blankLine:function(h){var j=h.innerActive?h.innerActive.mode:c;if(j.blankLine){j.blankLine(h.innerActive?h.inner:h.outer)}if(!h.innerActive){for(var g=0;g<b;++g){var f=e[g];if(f.open==="\n"){h.innerActive=f;h.inner=a.startState(f.mode,j.indent?j.indent(h.outer,""):0)}}}else{if(h.innerActive.close==="\n"){h.innerActive=h.inner=null}}},electricChars:c.electricChars,innerMode:function(f){return f.inner?{state:f.inner,mode:f.innerActive.mode}:{state:f.outer,mode:c}}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function a(e,g,d){this.orientation=g;this.scroll=d;this.screen=this.total=this.size=1;this.pos=0;this.node=document.createElement("div");this.node.className=e+"-"+g;this.inner=this.node.appendChild(document.createElement("div"));var f=this;b.on(this.inner,"mousedown",function(m){if(m.which!=1){return}b.e_preventDefault(m);var k=f.orientation=="horizontal"?"pageX":"pageY";var n=m[k],l=f.pos;function j(){b.off(document,"mousemove",i);b.off(document,"mouseup",j)}function i(o){if(o.which!=1){return j()}f.moveTo(l+(o[k]-n)*(f.total/f.size))}b.on(document,"mousemove",i);b.on(document,"mouseup",j)});b.on(this.node,"click",function(k){b.e_preventDefault(k);var i=f.inner.getBoundingClientRect(),j;if(f.orientation=="horizontal"){j=k.clientX<i.left?-1:k.clientX>i.right?1:0}else{j=k.clientY<i.top?-1:k.clientY>i.bottom?1:0}f.moveTo(f.pos+j*f.screen)});function h(k){var j=b.wheelEventPixels(k)[f.orientation=="horizontal"?"x":"y"];var i=f.pos;f.moveTo(f.pos+j);if(f.pos!=i){b.e_preventDefault(k)}}b.on(this.node,"mousewheel",h);b.on(this.node,"DOMMouseScroll",h)}a.prototype.moveTo=function(e,d){if(e<0){e=0}if(e>this.total-this.screen){e=this.total-this.screen}if(e==this.pos){return}this.pos=e;this.inner.style[this.orientation=="horizontal"?"left":"top"]=(e*(this.size/this.total))+"px";if(d!==false){this.scroll(e,this.orientation)}};a.prototype.update=function(d,e,f){this.screen=e;this.total=d;this.size=f;this.inner.style[this.orientation=="horizontal"?"width":"height"]=this.screen*(this.size/this.total)+"px";this.inner.style[this.orientation=="horizontal"?"left":"top"]=this.pos*(this.size/this.total)+"px"};function c(f,e,d){this.addClass=f;this.horiz=new a(f,"horizontal",d);e(this.horiz.node);this.vert=new a(f,"vertical",d);e(this.vert.node);this.width=null}c.prototype.update=function(g){if(this.width==null){var f=window.getComputedStyle?window.getComputedStyle(this.horiz.node):this.horiz.node.currentStyle;if(f){this.width=parseInt(f.height)}}var e=this.width||0;var h=g.scrollWidth>g.clientWidth+1;var d=g.scrollHeight>g.clientHeight+1;this.vert.node.style.display=d?"block":"none";this.horiz.node.style.display=h?"block":"none";if(d){this.vert.update(g.scrollHeight,g.clientHeight,g.viewHeight-(h?e:0));this.vert.node.style.display="block";this.vert.node.style.bottom=h?e+"px":"0"}if(h){this.horiz.update(g.scrollWidth,g.clientWidth,g.viewWidth-(d?e:0)-g.barLeft);this.horiz.node.style.right=d?e+"px":"0";this.horiz.node.style.left=g.barLeft+"px"}return{right:d?e:0,bottom:h?e:0}};c.prototype.setScrollTop=function(d){this.vert.moveTo(d,false)};c.prototype.setScrollLeft=function(d){this.horiz.moveTo(d,false)};c.prototype.clear=function(){var d=this.horiz.node.parentNode;d.removeChild(this.horiz.node);d.removeChild(this.vert.node)};b.scrollbarModel.simple=function(e,d){return new c("CodeMirror-simplescroll",e,d)};b.scrollbarModel.overlay=function(e,d){return new c("CodeMirror-overlayscroll",e,d)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var g="CodeMirror-activeline";var f="CodeMirror-activeline-background";c.defineOption("styleActiveLine",false,function(h,k,i){var j=i&&i!=c.Init;if(k&&!j){h.state.activeLines=[];e(h,h.listSelections());h.on("beforeSelectionChange",b)}else{if(!k&&j){h.off("beforeSelectionChange",b);d(h);delete h.state.activeLines}}});function d(h){for(var j=0;j<h.state.activeLines.length;j++){h.removeLineClass(h.state.activeLines[j],"wrap",g);h.removeLineClass(h.state.activeLines[j],"background",f)}}function a(j,h){if(j.length!=h.length){return false}for(var k=0;k<j.length;k++){if(j[k]!=h[k]){return false}}return true}function e(h,k){var n=[];for(var m=0;m<k.length;m++){var l=k[m];if(!l.empty()){continue}var j=h.getLineHandleVisualStart(l.head.line);if(n[n.length-1]!=j){n.push(j)}}if(a(h.state.activeLines,n)){return}h.operation(function(){d(h);for(var o=0;o<n.length;o++){h.addLineClass(n[o],"wrap",g);h.addLineClass(n[o],"background",f)}h.state.activeLines=n})}function b(h,i){e(h,i.ranges)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],a)}else{a(CodeMirror)}}})(function(b){var a=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"xi",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"dcc",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:false}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:true}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:true,linewise:true}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:false,linewise:true}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:true}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:false}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false,bigWord:true}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,inclusive:true}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,bigWord:true,inclusive:true}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false,bigWord:true}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,inclusive:true}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,bigWord:true,inclusive:true}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:false,toJumplist:true}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:true,toJumplist:true}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:true}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:false}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:true,explicitRepeat:true}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:false,explicitRepeat:true}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:true,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:false,toFirstChar:true}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:true}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:true,toJumplist:true}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:true,inclusive:true}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:false}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:true,inclusive:true}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:false}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:true}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:false}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:true,linewise:true}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:true}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:true}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:false}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:true,linewise:true}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:false,linewise:true}},{keys:"]p",type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true,matchIndent:true}},{keys:"[p",type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true,matchIndent:true}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:true,toJumplist:true}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:false,toJumplist:true}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:true},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:true}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:false}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:true},isEdit:true},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:false},isEdit:true},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:true}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:false,toJumplist:true}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:true},operatorMotionArgs:{visualLine:false}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:false},operatorMotionArgs:{visualLine:true}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:true},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:true},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:true},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:true},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:true},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:true},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:true},operatorArgs:{shouldMoveCursor:true},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:true}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:false}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:true,linewise:true}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:false,linewise:true}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:true},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:false},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:true}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:true}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:true},{keys:"p",type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true}},{keys:"P",type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true}},{keys:"r<character>",type:"action",action:"replace",isEdit:true},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{replace:true}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:true},context:"visual",isEdit:true},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:false},context:"visual",isEdit:true},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:true,backtrack:false}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:false,backtrack:false}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:true}},{keys:"/",type:"search",searchArgs:{forward:true,querySrc:"prompt",toJumplist:true}},{keys:"?",type:"search",searchArgs:{forward:false,querySrc:"prompt",toJumplist:true}},{keys:"*",type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:"#",type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:"g*",type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",toJumplist:true}},{keys:"g#",type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",toJumplist:true}},{keys:":",type:"ex"}];var c=b.Pos;var d=function(){function aU(by){by.setOption("disableInput",true);by.setOption("showCursorWhenSelecting",false);b.signal(by,"vim-mode-change",{mode:"normal"});by.on("cursorActivity",aa);G(by);b.on(by.getInputField(),"paste",U(by))}function aQ(by){by.setOption("disableInput",false);by.off("cursorActivity",aa);b.off(by.getInputField(),"paste",U(by));by.state.vim=null}function h(by,bz){if(this==b.keyMap.vim){b.rmClass(by.getWrapperElement(),"cm-fat-cursor")}if(!bz||bz.attach!=s){aQ(by,false)}}function s(by,bz){if(this==b.keyMap.vim){b.addClass(by.getWrapperElement(),"cm-fat-cursor")}if(!bz||bz.attach!=s){aU(by)}}b.defineOption("vimMode",false,function(by,bA,bz){if(bA&&by.getOption("keyMap")!="vim"){by.setOption("keyMap","vim")}else{if(!bA&&bz!=b.Init&&/^vim/.test(by.getOption("keyMap"))){by.setOption("keyMap","default")}}});function a2(bA,bz){if(!bz){return undefined}var by=L(bA);if(!by){return false}var bB=b.Vim.findKey(bz,by);if(typeof bB=="function"){b.signal(bz,"vim-keypress",by)}return bB}var az={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"};var aT={Enter:"CR",Backspace:"BS",Delete:"Del"};function L(bA){if(bA.charAt(0)=="'"){return bA.charAt(1)}var bD=bA.split("-");if(/-$/.test(bA)){bD.splice(-2,2,"-")}var by=bD[bD.length-1];if(bD.length==1&&bD[0].length==1){return false}else{if(bD.length==2&&bD[0]=="Shift"&&by.length==1){return false}}var bC=false;for(var bz=0;bz<bD.length;bz++){var bB=bD[bz];if(bB in az){bD[bz]=az[bB]}else{bC=true}if(bB in aT){bD[bz]=aT[bB]}}if(!bC){return false}if(A(by)){bD[bD.length-1]=by.toLowerCase()}return"<"+bD.join("-")+">"}function U(by){var bz=by.state.vim;if(!bz.onPasteFn){bz.onPasteFn=function(){if(!bz.insertMode){by.setCursor(D(by.getCursor(),0,1));p.enterInsertMode(by,{},bz)}}}return bz.onPasteFn}var aY=/[\d]/;var aq=[(/\w/),(/[^\w\s]/)],bl=[(/\S/)];function ap(bB,bz){var bA=[];for(var by=bB;by<bB+bz;by++){bA.push(String.fromCharCode(by))}return bA}var ah=ap(65,26);var am=ap(97,26);var V=ap(48,10);var aE=[].concat(ah,am,V,["<",">"]);var l=[].concat(ah,am,V,["-",'"',".",":","/"]);function f(by,bz){return bz>=by.firstLine()&&bz<=by.lastLine()}function E(by){return(/^[a-z]$/).test(by)}function N(by){return"()[]{}".indexOf(by)!=-1}function ag(by){return aY.test(by)}function A(by){return(/^[A-Z]$/).test(by)}function T(by){return(/^\s*$/).test(by)}function J(bA,by){for(var bz=0;bz<by.length;bz++){if(by[bz]==bA){return true}}return false}var at={};function aJ(bz,by,bA){if(by===undefined){throw Error("defaultValue is required")}if(!bA){bA="string"}at[bz]={type:bA,defaultValue:by};aH(bz,by)}function aH(by,bA){var bz=at[by];if(!bz){throw Error("Unknown option: "+by)}if(bz.type=="boolean"){if(bA&&bA!==true){throw Error("Invalid argument: "+by+"="+bA)}else{if(bA!==false){bA=true}}}bz.value=bz.type=="boolean"?!!bA:bA}function o(by){var bz=at[by];if(!bz){throw Error("Unknown option: "+by)}return bz.value}var ao=function(){var bC=100;var bE=-1;var bB=0;var bA=0;var bz=new Array(bC);function bD(bF,bH,bI){var bJ=bE%bC;var bK=bz[bJ];function bG(bN){var bM=++bE%bC;var bO=bz[bM];if(bO){bO.clear()}bz[bM]=bF.setBookmark(bN)}if(bK){var bL=bK.find();if(bL&&!bv(bL,bH)){bG(bH)}}else{bG(bH)}bG(bI);bB=bE;bA=bE-bC+1;if(bA<0){bA=0}}function by(bF,bJ){bE+=bJ;if(bE>bB){bE=bB}else{if(bE<bA){bE=bA}}var bK=bz[(bC+bE)%bC];if(bK&&!bK.find()){var bI=bJ>0?1:-1;var bH;var bG=bF.getCursor();do{bE+=bI;bK=bz[(bC+bE)%bC];if(bK&&(bH=bK.find())&&!bv(bG,bH)){break}}while(bE<bB&&bE>bA)}return bK}return{cachedCursor:undefined,add:bD,move:by}};var i=function(by){if(by){return{changes:by.changes,expectCursorActivityForChange:by.expectCursorActivityForChange}}return{changes:[],expectCursorActivityForChange:false}};function ax(){this.latestRegister=undefined;this.isPlaying=false;this.isRecording=false;this.replaySearchQueries=[];this.onRecordingDone=undefined;this.lastInsertModeChanges=i()}ax.prototype={exitMacroRecordMode:function(){var by=q.macroModeState;if(by.onRecordingDone){by.onRecordingDone()}by.onRecordingDone=undefined;by.isRecording=false},enterMacroRecordMode:function(by,bA){var bz=q.registerController.getRegister(bA);if(bz){bz.clear();this.latestRegister=bA;if(by.openDialog){this.onRecordingDone=by.openDialog("(recording)["+bA+"]",null,{bottom:true})}this.isRecording=true}}};function G(by){if(!by.state.vim){by.state.vim={inputState:new aA(),lastEditInputState:undefined,lastEditActionCommand:undefined,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:false,insertModeRepeat:undefined,visualMode:false,visualLine:false,visualBlock:false,lastSelection:null,lastPastedText:null,sel:{}}}return by.state.vim}var q;function z(){q={searchQuery:null,searchIsReversed:false,lastSubstituteReplacePart:undefined,jumpList:ao(),macroModeState:new ax,lastChararacterSearch:{increment:0,forward:true,selectedCharacter:""},registerController:new ai({}),searchHistoryController:new a3({}),exCommandHistoryController:new a3({})};for(var by in at){var bz=at[by];bz.value=bz.defaultValue}}var bt;var aN={buildKeyMap:function(){},getRegisterController:function(){return q.registerController},resetVimGlobalState_:z,getVimGlobalState_:function(){return q},maybeInitVimState_:G,suppressErrorLogging:false,InsertModeKey:bi,map:function(bz,bA,by){m.map(bz,bA,by)},setOption:aH,getOption:o,defineOption:aJ,defineEx:function(by,bA,bz){if(by.indexOf(bA)!==0){throw new Error('(Vim.defineEx) "'+bA+'" is not a prefix of "'+by+'", command not registered')}a4[by]=bz;m.commandMap_[bA]={name:by,shortName:bA,type:"api"}},handleKey:function(by,bA,bz){var bB=this.findKey(by,bA,bz);if(typeof bB==="function"){return bB()}},findKey:function(bE,bF,bD){var bB=G(bE);function bG(){var bI=q.macroModeState;if(bI.isRecording){if(bF=="q"){bI.exitMacroRecordMode();j(bE);return true}if(bD!="mapping"){I(bI,bF)}}}function bH(){if(bF=="<Esc>"){j(bE);if(bB.visualMode){aR(bE)}else{if(bB.insertMode){v(bE)}}return true}}function by(bJ){var bI;while(bJ){bI=(/<\w+-.+?>|<\w+>|./).exec(bJ);bF=bI[0];bJ=bJ.substring(bI.index+bF.length);b.Vim.handleKey(bE,bF,"mapping")}}function bC(){if(bH()){return true}var bK=bB.inputState.keyBuffer=bB.inputState.keyBuffer+bF;var bL=bF.length==1;var bI=ba.matchCommand(bK,a,bB.inputState,"insert");while(bK.length>1&&bI.type!="full"){var bK=bB.inputState.keyBuffer=bK.slice(1);var bM=ba.matchCommand(bK,a,bB.inputState,"insert");if(bM.type!="none"){bI=bM}}if(bI.type=="none"){j(bE);return false}else{if(bI.type=="partial"){if(bt){window.clearTimeout(bt)}bt=window.setTimeout(function(){if(bB.insertMode&&bB.inputState.keyBuffer){j(bE)}},o("insertModeEscKeysTimeout"));return !bL}}if(bt){window.clearTimeout(bt)}if(bL){var bJ=bE.getCursor();bE.replaceRange("",D(bJ,0,-(bK.length-1)),bJ,"+input")}j(bE);return bI.command}function bA(){if(bG()||bH()){return true}var bK=bB.inputState.keyBuffer=bB.inputState.keyBuffer+bF;if(/^[1-9]\d*$/.test(bK)){return true}var bL=/^(\d*)(.*)$/.exec(bK);if(!bL){j(bE);return false}var bJ=bB.visualMode?"visual":"normal";var bI=ba.matchCommand(bL[2]||bL[1],a,bB.inputState,bJ);if(bI.type=="none"){j(bE);return false}else{if(bI.type=="partial"){return true}}bB.inputState.keyBuffer="";var bL=/^(\d*)(.*)$/.exec(bK);if(bL[1]&&bL[1]!="0"){bB.inputState.pushRepeatDigit(bL[1])}return bI.command}var bz;if(bB.insertMode){bz=bC()}else{bz=bA()}if(bz===false){return undefined}else{if(bz===true){return function(){}}else{return function(){return bE.operation(function(){bE.curOp.isVimOp=true;try{if(bz.type=="keyToKey"){by(bz.toKeys)}else{ba.processCommand(bE,bB,bz)}}catch(bI){bE.state.vim=undefined;G(bE);if(!b.Vim.suppressErrorLogging){console.log(bI)}throw bI}return true})}}}},handleEx:function(by,bz){m.processCommand(by,bz)}};function aA(){this.prefixRepeat=[];this.motionRepeat=[];this.operator=null;this.operatorArgs=null;this.motion=null;this.motionArgs=null;this.keyBuffer=[];this.registerName=null}aA.prototype.pushRepeatDigit=function(by){if(!this.operator){this.prefixRepeat=this.prefixRepeat.concat(by)}else{this.motionRepeat=this.motionRepeat.concat(by)}};aA.prototype.getRepeat=function(){var by=0;if(this.prefixRepeat.length>0||this.motionRepeat.length>0){by=1;if(this.prefixRepeat.length>0){by*=parseInt(this.prefixRepeat.join(""),10)}if(this.motionRepeat.length>0){by*=parseInt(this.motionRepeat.join(""),10)}}return by};function j(by,bz){by.state.vim.inputState=new aA();b.signal(by,"vim-command-done",bz)}function bn(bA,bz,by){this.clear();this.keyBuffer=[bA||""];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!!bz;this.blockwise=!!by}bn.prototype={setText:function(bA,bz,by){this.keyBuffer=[bA||""];this.linewise=!!bz;this.blockwise=!!by},pushText:function(bz,by){if(by){if(!this.linewise){this.keyBuffer.push("\n")}this.linewise=true}this.keyBuffer.push(bz)},pushInsertModeChanges:function(by){this.insertModeChanges.push(i(by))},pushSearchQuery:function(by){this.searchQueries.push(by)},clear:function(){this.keyBuffer=[];this.insertModeChanges=[];this.searchQueries=[];this.linewise=false},toString:function(){return this.keyBuffer.join("")}};function ai(by){this.registers=by;this.unnamedRegister=by['"']=new bn();by["."]=new bn();by[":"]=new bn();by["/"]=new bn()}ai.prototype={pushText:function(bC,bz,bE,bD,bA){if(bD&&bE.charAt(0)=="\n"){bE=bE.slice(1)+"\n"}if(bD&&bE.charAt(bE.length-1)!=="\n"){bE+="\n"}var bB=this.isValidRegister(bC)?this.getRegister(bC):null;if(!bB){switch(bz){case"yank":this.registers["0"]=new bn(bE,bD,bA);break;case"delete":case"change":if(bE.indexOf("\n")==-1){this.registers["-"]=new bn(bE,bD)}else{this.shiftNumericRegisters_();this.registers["1"]=new bn(bE,bD)}break}this.unnamedRegister.setText(bE,bD,bA);return}var by=A(bC);if(by){bB.pushText(bE,bD)}else{bB.setText(bE,bD,bA)}this.unnamedRegister.setText(bB.toString(),bD)},getRegister:function(by){if(!this.isValidRegister(by)){return this.unnamedRegister}by=by.toLowerCase();if(!this.registers[by]){this.registers[by]=new bn()}return this.registers[by]},isValidRegister:function(by){return by&&J(by,l)},shiftNumericRegisters_:function(){for(var by=9;by>=2;by--){this.registers[by]=this.getRegister(""+(by-1))}}};function a3(){this.historyBuffer=[];this.iterator;this.initialPrefix=null}a3.prototype={nextMatch:function(bz,by){var bE=this.historyBuffer;var bB=by?-1:1;if(this.initialPrefix===null){this.initialPrefix=bz}for(var bD=this.iterator+bB;by?bD>=0:bD<bE.length;bD+=bB){var bC=bE[bD];for(var bA=0;bA<=bC.length;bA++){if(this.initialPrefix==bC.substring(0,bA)){this.iterator=bD;return bC}}}if(bD>=bE.length){this.iterator=bE.length;return this.initialPrefix}if(bD<0){return bz}},pushInput:function(by){var bz=this.historyBuffer.indexOf(by);if(bz>-1){this.historyBuffer.splice(bz,1)}if(by.length){this.historyBuffer.push(by)}},reset:function(){this.initialPrefix=null;this.iterator=this.historyBuffer.length}};var ba={matchCommand:function(bD,bF,by,bB){var bE=bj(bD,bF,bB,by);if(!bE.full&&!bE.partial){return{type:"none"}}else{if(!bE.full&&bE.partial){return{type:"partial"}}}var bC;for(var bA=0;bA<bE.full.length;bA++){var bz=bE.full[bA];if(!bC){bC=bz}}if(bC.keys.slice(-11)=="<character>"){by.selectedCharacter=Q(bD)}return{type:"full",command:bC}},processCommand:function(by,bz,bA){bz.inputState.repeatOverride=bA.repeatOverride;switch(bA.type){case"motion":this.processMotion(by,bz,bA);break;case"operator":this.processOperator(by,bz,bA);break;case"operatorMotion":this.processOperatorMotion(by,bz,bA);break;case"action":this.processAction(by,bz,bA);break;case"search":this.processSearch(by,bz,bA);j(by);break;case"ex":case"keyToEx":this.processEx(by,bz,bA);j(by);break;default:break}},processMotion:function(by,bz,bA){bz.inputState.motion=bA.motion;bz.inputState.motionArgs=bh(bA.motionArgs);this.evalInput(by,bz)},processOperator:function(bz,bA,bB){var by=bA.inputState;if(by.operator){if(by.operator==bB.operator){by.motion="expandToLine";by.motionArgs={linewise:true};this.evalInput(bz,bA);return}else{j(bz)}}by.operator=bB.operator;by.operatorArgs=bh(bB.operatorArgs);if(bA.visualMode){this.evalInput(bz,bA)}},processOperatorMotion:function(by,bB,bC){var bA=bB.visualMode;var bz=bh(bC.operatorMotionArgs);if(bz){if(bA&&bz.visualLine){bB.visualLine=true}}this.processOperator(by,bB,bC);if(!bA){this.processMotion(by,bB,bC)}},processAction:function(bz,bB,bE){var by=bB.inputState;var bD=by.getRepeat();var bC=!!bD;var bA=bh(bE.actionArgs)||{};if(by.selectedCharacter){bA.selectedCharacter=by.selectedCharacter}if(bE.operator){this.processOperator(bz,bB,bE)}if(bE.motion){this.processMotion(bz,bB,bE)}if(bE.motion||bE.operator){this.evalInput(bz,bB)}bA.repeat=bD||1;bA.repeatIsExplicit=bC;bA.registerName=by.registerName;j(bz);bB.lastMotion=null;if(bE.isEdit){this.recordLastEdit(bB,by,bE)}p[bE.action](bz,bA,bB)},processSearch:function(bN,bG,bF){if(!bN.getSearchCursor){return}var bI=bF.searchArgs.forward;var bD=bF.searchArgs.wholeWordOnly;aG(bN).setReversed(!bI);var bJ=(bI)?"/":"?";var bL=aG(bN).getQuery();var bA=bN.getScrollInfo();function bE(bQ,bO,bP){q.searchHistoryController.pushInput(bQ);q.searchHistoryController.reset();try{bu(bN,bQ,bO,bP)}catch(bR){bk(bN,"Invalid regex: "+bQ);return}ba.processMotion(bN,bG,{type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:bF.searchArgs.toJumplist}})}function bM(bO){bN.scrollTo(bA.left,bA.top);bE(bO,true,true);var bP=q.macroModeState;if(bP.isRecording){O(bP,bO)}}function bC(bS,bR,bT){var bQ=b.keyName(bS),bO;if(bQ=="Up"||bQ=="Down"){bO=bQ=="Up"?true:false;bR=q.searchHistoryController.nextMatch(bR,bO)||"";bT(bR)}else{if(bQ!="Left"&&bQ!="Right"&&bQ!="Ctrl"&&bQ!="Alt"&&bQ!="Shift"){q.searchHistoryController.reset()}}var bP;try{bP=bu(bN,bR,true,true)}catch(bS){}if(bP){bN.scrollIntoView(bw(bN,!bI,bP),30)}else{aK(bN);bN.scrollTo(bA.left,bA.top)}}function bz(bQ,bP,bR){var bO=b.keyName(bQ);if(bO=="Esc"||bO=="Ctrl-C"||bO=="Ctrl-["){q.searchHistoryController.pushInput(bP);q.searchHistoryController.reset();bu(bN,bL);aK(bN);bN.scrollTo(bA.left,bA.top);b.e_stop(bQ);bR();bN.focus()}}switch(bF.searchArgs.querySrc){case"prompt":var bH=q.macroModeState;if(bH.isPlaying){var bK=bH.replaySearchQueries.shift();bE(bK,true,false)}else{a0(bN,{onClose:bM,prefix:bJ,desc:P,onKeyUp:bC,onKeyDown:bz})}break;case"wordUnderCursor":var bB=aD(bN,false,true,false,true);var by=true;if(!bB){bB=aD(bN,false,true,false,false);by=false}if(!bB){return}var bK=bN.getLine(bB.start.line).substring(bB.start.ch,bB.end.ch);if(by&&bD){bK="\\b"+bK+"\\b"}else{bK=g(bK)}q.jumpList.cachedCursor=bN.getCursor();bN.setCursor(bB.start);bE(bK,true,false);break}},processEx:function(by,bz,bC){function bB(bD){q.exCommandHistoryController.pushInput(bD);q.exCommandHistoryController.reset();m.processCommand(by,bD)}function bA(bG,bE,bH){var bF=b.keyName(bG),bD;if(bF=="Esc"||bF=="Ctrl-C"||bF=="Ctrl-["){q.exCommandHistoryController.pushInput(bE);q.exCommandHistoryController.reset();b.e_stop(bG);bH();by.focus()}if(bF=="Up"||bF=="Down"){bD=bF=="Up"?true:false;bE=q.exCommandHistoryController.nextMatch(bE,bD)||"";bH(bE)}else{if(bF!="Left"&&bF!="Right"&&bF!="Ctrl"&&bF!="Alt"&&bF!="Shift"){q.exCommandHistoryController.reset()}}}if(bC.type=="keyToEx"){m.processCommand(by,bC.exArgs.input)}else{if(bz.visualMode){a0(by,{onClose:bB,prefix:":",value:"'<,'>",onKeyDown:bA})}else{a0(by,{onClose:bB,prefix:":",onKeyDown:bA})}}},evalInput:function(bG,bS){var bL=bS.inputState;var bP=bL.motion;var bM=bL.motionArgs||{};var bH=bL.operator;var b2=bL.operatorArgs||{};var bN=bL.registerName;var bT=bS.sel;var b3=C(bS.visualMode?bT.head:bG.getCursor("head"));var bE=C(bS.visualMode?bT.anchor:bG.getCursor("anchor"));var bB=C(b3);var bA=C(bE);var bR,bK;var bI;if(bH){this.recordLastEdit(bS,bL)}if(bL.repeatOverride!==undefined){bI=bL.repeatOverride}else{bI=bL.getRepeat()}if(bI>0&&bM.explicitRepeat){bM.repeatIsExplicit=true}else{if(bM.noRepeat||(!bM.explicitRepeat&&bI===0)){bI=1;bM.repeatIsExplicit=false}}if(bL.selectedCharacter){bM.selectedCharacter=b2.selectedCharacter=bL.selectedCharacter}bM.repeat=bI;j(bG);if(bP){var bQ=a1[bP](bG,b3,bM,bS);bS.lastMotion=a1[bP];if(!bQ){return}if(bM.toJumplist){var b1=q.jumpList;var bJ=b1.cachedCursor;if(bJ){be(bG,bJ,bQ);delete b1.cachedCursor}else{be(bG,b3,bQ)}}if(bQ instanceof Array){bK=bQ[0];bR=bQ[1]}else{bR=bQ}if(!bR){bR=C(b3)}if(bS.visualMode){if(!(bS.visualBlock&&bR.ch===Infinity)){bR=Z(bG,bR,bS.visualBlock)}if(bK){bK=Z(bG,bK,true)}bK=bK||bA;bT.anchor=bK;bT.head=bR;M(bG);aP(bG,bS,"<",aM(bK,bR)?bK:bR);aP(bG,bS,">",aM(bK,bR)?bR:bK)}else{if(!bH){bR=Z(bG,bR);bG.setCursor(bR.line,bR.ch)}}}if(bH){if(b2.lastSel){bK=bA;var by=b2.lastSel;var bY=Math.abs(by.head.line-by.anchor.line);var b0=Math.abs(by.head.ch-by.anchor.ch);if(by.visualLine){bR=c(bA.line+bY,bA.ch)}else{if(by.visualBlock){bR=c(bA.line+bY,bA.ch+b0)}else{if(by.head.line==by.anchor.line){bR=c(bA.line,bA.ch+b0)}else{bR=c(bA.line+bY,bA.ch)}}}bS.visualMode=true;bS.visualLine=by.visualLine;bS.visualBlock=by.visualBlock;bT=bS.sel={anchor:bK,head:bR};M(bG)}else{if(bS.visualMode){b2.lastSel={anchor:C(bT.anchor),head:C(bT.head),visualBlock:bS.visualBlock,visualLine:bS.visualLine}}}var bF,bU,bC,bO;var bD;if(bS.visualMode){bF=av(bT.head,bT.anchor);bU=a8(bT.head,bT.anchor);bC=bS.visualLine||b2.linewise;bO=bS.visualBlock?"block":bC?"line":"char";bD=bx(bG,{anchor:bF,head:bU},bO);if(bC){var bz=bD.ranges;if(bO=="block"){for(var bV=0;bV<bz.length;bV++){bz[bV].head.ch=aV(bG,bz[bV].head.line)}}else{if(bO=="line"){bz[0].head=c(bz[0].head.line+1,0)}}}}else{bF=C(bK||bA);bU=C(bR||bB);if(aM(bU,bF)){var bZ=bF;bF=bU;bU=bZ}bC=bM.linewise||b2.linewise;if(bC){bc(bG,bF,bU)}else{if(bM.forward){al(bG,bF,bU)}}bO="char";var bX=!bM.inclusive||bC;bD=bx(bG,{anchor:bF,head:bU},bO,bX)}bG.setSelections(bD.ranges,bD.primary);bS.lastMotion=null;b2.repeat=bI;b2.registerName=bN;b2.linewise=bC;var bW=K[bH](bG,b2,bD.ranges,bA,bR);if(bS.visualMode){aR(bG)}if(bW){bG.setCursor(bW)}}},recordLastEdit:function(bz,by,bA){var bB=q.macroModeState;if(bB.isPlaying){return}bz.lastEditInputState=by;bz.lastEditActionCommand=bA;bB.lastInsertModeChanges.changes=[];bB.lastInsertModeChanges.expectCursorActivityForChange=false}};var a1={moveToTopLine:function(by,bA,bB){var bz=bb(by).top+bB.repeat-1;return c(bz,aZ(by.getLine(bz)))},moveToMiddleLine:function(by){var bA=bb(by);var bz=Math.floor((bA.top+bA.bottom)*0.5);return c(bz,aZ(by.getLine(bz)))},moveToBottomLine:function(by,bA,bB){var bz=bb(by).bottom-bB.repeat+1;return c(bz,aZ(by.getLine(bz)))},expandToLine:function(bA,bz,by){var bB=bz;return c(bB.line+by.repeat-1,Infinity)},findNext:function(by,bz,bA){var bD=aG(by);var bC=bD.getQuery();if(!bC){return}var bB=!bA.forward;bB=(bD.isReversed())?!bB:bB;aI(by,bC);return bw(by,bB,bC,bA.repeat)},goToMark:function(by,bA,bB,bz){var bD=bz.marks[bB.selectedCharacter];if(bD){var bC=bD.find();return bB.linewise?{line:bC.line,ch:aZ(by.getLine(bC.line))}:bC}return null},moveToOtherHighlightedEnd:function(by,bA,bB,bz){if(bz.visualBlock&&bB.sameLine){var bC=bz.sel;return[Z(by,c(bC.anchor.line,bC.head.ch)),Z(by,c(bC.head.line,bC.anchor.ch))]}else{return([bz.sel.head,bz.sel.anchor])}},jumpToMark:function(bG,bF,bB,bC){var bA=bF;for(var bD=0;bD<bB.repeat;bD++){var bI=bA;for(var bH in bC.marks){if(!E(bH)){continue}var bz=bC.marks[bH].find();var by=(bB.forward)?aM(bz,bI):aM(bI,bz);if(by){continue}if(bB.linewise&&(bz.line==bI.line)){continue}var bE=bv(bI,bA);var bJ=(bB.forward)?au(bI,bz,bA):au(bA,bz,bI);if(bE||bJ){bA=bz}}}if(bB.linewise){bA=c(bA.line,aZ(bG.getLine(bA.line)))}return bA},moveByCharacters:function(bB,bz,by){var bD=bz;var bC=by.repeat;var bA=by.forward?bD.ch+bC:bD.ch-bC;return c(bD.line,bA)},moveByLines:function(bE,bD,bz,bA){var bG=bD;var bB=bG.ch;switch(bA.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:bB=bA.lastHPos;break;default:bA.lastHPos=bB}var by=bz.repeat+(bz.repeatOffset||0);var bH=bz.forward?bG.line+by:bG.line-by;var bC=bE.firstLine();var bF=bE.lastLine();if((bH<bC&&bG.line==bC)||(bH>bF&&bG.line==bF)){return}if(bz.toFirstChar){bB=aZ(bE.getLine(bH));bA.lastHPos=bB}bA.lastHSPos=bE.charCoords(c(bH,bB),"div").left;return c(bH,bB)},moveByDisplayLines:function(bG,bF,bA,bB){var bH=bF;switch(bB.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:bB.lastHSPos=bG.charCoords(bH,"div").left}var by=bA.repeat;var bE=bG.findPosV(bH,(bA.forward?by:-by),"line",bB.lastHSPos);if(bE.hitSide){if(bA.forward){var bz=bG.charCoords(bE,"div");var bC={top:bz.top+8,left:bB.lastHSPos};var bE=bG.coordsChar(bC,"div")}else{var bD=bG.charCoords(c(bG.firstLine(),0),"div");bD.left=bB.lastHSPos;bE=bG.coordsChar(bD,"div")}}bB.lastHPos=bE.ch;return bE},moveByPage:function(bz,bB,bA){var by=bB;var bC=bA.repeat;return bz.findPosV(by,(bA.forward?bC:-bC),"page")},moveByParagraph:function(by,bB,bA){var bz=bA.forward?1:-1;return bm(by,bB,bA.repeat,bz)},moveByScroll:function(bE,bB,bz,bA){var bF=bE.getScrollInfo();var bG=null;var by=bz.repeat;if(!by){by=bF.clientHeight/(2*bE.defaultTextHeight())}var bD=bE.charCoords(bB,"local");bz.repeat=by;var bG=a1.moveByDisplayLines(bE,bB,bz,bA);if(!bG){return null}var bC=bE.charCoords(bG,"local");bE.scrollTo(null,bF.top+bC.top-bD.top);return bG},moveByWords:function(by,bA,bz){return aB(by,bA,bz.repeat,!!bz.forward,!!bz.wordEnd,!!bz.bigWord)},moveTillCharacter:function(bz,bA,bB){var bD=bB.repeat;var bC=bp(bz,bD,bB.forward,bB.selectedCharacter);var by=bB.forward?-1:1;aC(by,bB);if(!bC){return null}bC.ch+=by;return bC},moveToCharacter:function(by,bA,bz){var bB=bz.repeat;aC(0,bz);return bp(by,bB,bz.forward,bz.selectedCharacter)||bA},moveToSymbol:function(by,bA,bz){var bB=bz.repeat;return bq(by,bB,bz.forward,bz.selectedCharacter)||bA},moveToColumn:function(by,bB,bA,bz){var bC=bA.repeat;bz.lastHPos=bC-1;bz.lastHSPos=by.charCoords(bB,"div").left;return aj(by,bC)},moveToEol:function(by,bD,bC,bB){var bE=bD;bB.lastHPos=Infinity;var bA=c(bE.line+bC.repeat-1,Infinity);var bz=by.clipPos(bA);bz.ch--;bB.lastHSPos=by.charCoords(bz,"div").left;return bA},moveToFirstNonWhiteSpaceCharacter:function(by,bz){var bA=bz;return c(bA.line,aZ(by.getLine(bA.line)))},moveToMatchedSymbol:function(bE,bC){var bF=bC;var bG=bF.line;var by=bF.ch;var bD=bE.getLine(bG);var bB;do{bB=bD.charAt(by++);if(bB&&N(bB)){var bz=bE.getTokenTypeAt(c(bG,by));if(bz!=="string"&&bz!=="comment"){break}}}while(bB);if(bB){var bA=bE.findMatchingBracket(c(bG,by));return bA.to}else{return bF}},moveToStartOfLine:function(bz,by){return c(by.line,0)},moveToLineOrEdgeOfDocument:function(by,bz,bA){var bB=bA.forward?by.lastLine():by.firstLine();if(bA.repeatIsExplicit){bB=bA.repeat-by.getOption("firstLineNumber")}return c(bB,aZ(by.getLine(bB)))},textObjectManipulation:function(bG,bE,bA,bB){var by={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["};var bH={"'":true,'"':true};var bD=bA.selectedCharacter;if(bD=="b"){bD="("}else{if(bD=="B"){bD="{"}}var bF=!bA.textObjectInner;var bC;if(by[bD]){bC=n(bG,bE,bD,bF)}else{if(bH[bD]){bC=aO(bG,bE,bD,bF)}else{if(bD==="W"){bC=aD(bG,bF,true,true)}else{if(bD==="w"){bC=aD(bG,bF,true,false)}else{if(bD==="p"){bC=bm(bG,bE,bA.repeat,0,bF);bA.linewise=true;if(bB.visualMode){if(!bB.visualLine){bB.visualLine=true}}else{var bz=bB.inputState.operatorArgs;if(bz){bz.linewise=true}bC.end.line--}}else{return null}}}}}if(!bG.state.vim.visualMode){return[bC.start,bC.end]}else{return t(bG,bC.start,bC.end)}},repeatLastCharacterSearch:function(bA,bD,bC){var bz=q.lastChararacterSearch;var bF=bC.repeat;var bB=bC.forward===bz.forward;var by=(bz.increment?1:0)*(bB?-1:1);bA.moveH(-by,"char");bC.inclusive=bB?true:false;var bE=bp(bA,bF,bB,bz.selectedCharacter);if(!bE){bA.moveH(by,"char");return bD}bE.ch+=by;return bE}};function y(bB,bA){var by=[];for(var bz=0;bz<bA;bz++){by.push(bB)}return by}var K={change:function(bH,bF,bz){var bE,bI;var bB=bH.state.vim;q.macroModeState.lastInsertModeChanges.inVisualBlock=bB.visualBlock;if(!bB.visualMode){var bC=bz[0].anchor,bG=bz[0].head;bI=bH.getRange(bC,bG);if(!T(bI)){var bD=(/\s+$/).exec(bI);if(bD){bG=D(bG,0,-bD[0].length);bI=bI.slice(0,-bD[0].length)}}var by=bG.line-1==bH.lastLine();bH.replaceRange("",bC,bG);if(bF.linewise&&!by){b.commands.newlineAndIndent(bH);bC.ch=null}bE=bC}else{bI=bH.getSelection();var bA=y("",bz.length);bH.replaceSelections(bA);bE=av(bz[0].head,bz[0].anchor)}q.registerController.pushText(bF.registerName,"change",bI,bF.linewise,bz.length>1);p.enterInsertMode(bH,{head:bE},bH.state.vim)},"delete":function(bF,bD,by){var bC,bG;var bA=bF.state.vim;if(!bA.visualBlock){var bB=by[0].anchor,bE=by[0].head;if(bD.linewise&&bE.line!=bF.firstLine()&&bB.line==bF.lastLine()&&bB.line==bE.line-1){if(bB.line==bF.firstLine()){bB.ch=0}else{bB=c(bB.line-1,aV(bF,bB.line-1))}}bG=bF.getRange(bB,bE);bF.replaceRange("",bB,bE);bC=bB;if(bD.linewise){bC=a1.moveToFirstNonWhiteSpaceCharacter(bF,bB)}}else{bG=bF.getSelection();var bz=y("",by.length);bF.replaceSelections(bz);bC=by[0].anchor}q.registerController.pushText(bD.registerName,"delete",bG,bD.linewise,bA.visualBlock);return bC},indent:function(bF,bE,by){var bC=bF.state.vim;var bG=by[0].anchor.line;var bA=bC.visualBlock?by[by.length-1].anchor.line:by[0].head.line;var bz=(bC.visualMode)?bE.repeat:1;if(bE.linewise){bA--}for(var bD=bG;bD<=bA;bD++){for(var bB=0;bB<bz;bB++){bF.indentLine(bD,bE.indentRight)}}return a1.moveToFirstNonWhiteSpaceCharacter(bF,by[0].anchor)},changeCase:function(bJ,bI,by,bF,bC){var bz=bJ.getSelections();var bA=[];var bB=bI.toLower;for(var bD=0;bD<bz.length;bD++){var bG=bz[bD];var bK="";if(bB===true){bK=bG.toLowerCase()}else{if(bB===false){bK=bG.toUpperCase()}else{for(var bE=0;bE<bG.length;bE++){var bH=bG.charAt(bE);bK+=A(bH)?bH.toLowerCase():bH.toUpperCase()}}}bA.push(bK)}bJ.replaceSelections(bA);if(bI.shouldMoveCursor){return bC}else{if(!bJ.state.vim.visualMode&&bI.linewise&&by[0].anchor.line+1==by[0].head.line){return a1.moveToFirstNonWhiteSpaceCharacter(bJ,bF)}else{if(bI.linewise){return bF}else{return av(by[0].anchor,by[0].head)}}}},yank:function(by,bD,bz,bB){var bA=by.state.vim;var bE=by.getSelection();var bC=bA.visualMode?av(bA.sel.anchor,bA.sel.head,bz[0].head,bz[0].anchor):bB;q.registerController.pushText(bD.registerName,"yank",bE,bD.linewise,bA.visualBlock);return bC}};var p={jumpListWalk:function(by,bA,bB){if(bB.visualMode){return}var bD=bA.repeat;var bC=bA.forward;var bz=q.jumpList;var bF=bz.move(by,bC?bD:-bD);var bE=bF?bF.find():undefined;bE=bE?bE:by.getCursor();by.setCursor(bE)},scroll:function(bG,bA,bC){if(bC.visualMode){return}var by=bA.repeat||1;var bF=bG.defaultTextHeight();var bE=bG.getScrollInfo().top;var bH=bF*by;var bD=bA.forward?bE+bH:bE-bH;var bI=C(bG.getCursor());var bB=bG.charCoords(bI,"local");if(bA.forward){if(bD>bB.top){bI.line+=(bD-bB.top)/bF;bI.line=Math.ceil(bI.line);bG.setCursor(bI);bB=bG.charCoords(bI,"local");bG.scrollTo(null,bB.top)}else{bG.scrollTo(null,bD)}}else{var bz=bD+bG.getScrollInfo().clientHeight;if(bz<bB.bottom){bI.line-=(bB.bottom-bz)/bF;bI.line=Math.floor(bI.line);bG.setCursor(bI);bB=bG.charCoords(bI,"local");bG.scrollTo(null,bB.bottom-bG.getScrollInfo().clientHeight)}else{bG.scrollTo(null,bD)}}},scrollToCursor:function(bz,bA){var bD=bz.getCursor().line;var bB=bz.charCoords(c(bD,0),"local");var by=bz.getScrollInfo().clientHeight;var bE=bB.top;var bC=bB.bottom-bE;switch(bA.position){case"center":bE=bE-(by/2)+bC;break;case"bottom":bE=bE-by+bC*1.4;break;case"top":bE=bE+bC*0.4;break}bz.scrollTo(null,bE)},replayMacro:function(by,bz,bA){var bB=bz.selectedCharacter;var bC=bz.repeat;var bD=q.macroModeState;if(bB=="@"){bB=bD.latestRegister}while(bC--){H(by,bA,bD,bB)}},enterMacroRecordMode:function(by,bz){var bB=q.macroModeState;var bA=bz.selectedCharacter;bB.enterMacroRecordMode(by,bA)},enterInsertMode:function(bz,bA,bB){if(bz.getOption("readOnly")){return}bB.insertMode=true;bB.insertModeRepeat=bA&&bA.repeat||1;var bD=(bA)?bA.insertAt:null;var bE=bB.sel;var bC=bA.head||bz.getCursor("head");var by=bz.listSelections().length;if(bD=="eol"){bC=c(bC.line,aV(bz,bC.line))}else{if(bD=="charAfter"){bC=D(bC,0,1)}else{if(bD=="firstNonBlank"){bC=a1.moveToFirstNonWhiteSpaceCharacter(bz,bC)}else{if(bD=="startOfSelectedArea"){if(!bB.visualBlock){if(bE.head.line<bE.anchor.line){bC=bE.head}else{bC=c(bE.anchor.line,0)}}else{bC=c(Math.min(bE.head.line,bE.anchor.line),Math.min(bE.head.ch,bE.anchor.ch));by=Math.abs(bE.head.line-bE.anchor.line)+1}}else{if(bD=="endOfSelectedArea"){if(!bB.visualBlock){if(bE.head.line>=bE.anchor.line){bC=D(bE.head,0,1)}else{bC=c(bE.anchor.line,0)}}else{bC=c(Math.min(bE.head.line,bE.anchor.line),Math.max(bE.head.ch+1,bE.anchor.ch));by=Math.abs(bE.head.line-bE.anchor.line)+1}}else{if(bD=="inplace"){if(bB.visualMode){return}}}}}}}bz.setOption("keyMap","vim-insert");bz.setOption("disableInput",false);if(bA&&bA.replace){bz.toggleOverwrite(true);bz.setOption("keyMap","vim-replace");b.signal(bz,"vim-mode-change",{mode:"replace"})}else{bz.setOption("keyMap","vim-insert");b.signal(bz,"vim-mode-change",{mode:"insert"})}if(!q.macroModeState.isPlaying){bz.on("change",bg);b.on(bz.getInputField(),"keydown",W)}if(bB.visualMode){aR(bz)}aS(bz,bC,by)},toggleVisualMode:function(by,bz,bA){var bD=bz.repeat;var bB=by.getCursor();var bC;if(!bA.visualMode){bA.visualMode=true;bA.visualLine=!!bz.linewise;bA.visualBlock=!!bz.blockwise;bC=Z(by,c(bB.line,bB.ch+bD-1),true);bA.sel={anchor:bB,head:bC};b.signal(by,"vim-mode-change",{mode:"visual",subMode:bA.visualLine?"linewise":bA.visualBlock?"blockwise":""});M(by);aP(by,bA,"<",av(bB,bC));aP(by,bA,">",a8(bB,bC))}else{if(bA.visualLine^bz.linewise||bA.visualBlock^bz.blockwise){bA.visualLine=!!bz.linewise;bA.visualBlock=!!bz.blockwise;b.signal(by,"vim-mode-change",{mode:"visual",subMode:bA.visualLine?"linewise":bA.visualBlock?"blockwise":""});M(by)}else{aR(by)}}},reselectLastSelection:function(by,bD,bA){var bz=bA.lastSelection;if(bA.visualMode){bf(by,bA)}if(bz){var bB=bz.anchorMark.find();var bC=bz.headMark.find();if(!bB||!bC){return}bA.sel={anchor:bB,head:bC};bA.visualMode=true;bA.visualLine=bz.visualLine;bA.visualBlock=bz.visualBlock;M(by);aP(by,bA,"<",av(bB,bC));aP(by,bA,">",a8(bB,bC));b.signal(by,"vim-mode-change",{mode:"visual",subMode:bA.visualLine?"linewise":bA.visualBlock?"blockwise":""})}},joinLines:function(bF,bz,bB){var bE,bH;if(bB.visualMode){bE=bF.getCursor("anchor");bH=bF.getCursor("head");bH.ch=aV(bF,bH.line)-1}else{var by=Math.max(bz.repeat,2);bE=bF.getCursor();bH=Z(bF,c(bE.line+by-1,Infinity))}var bA=0;for(var bD=bE.line;bD<bH.line;bD++){bA=aV(bF,bE.line);var bC=c(bE.line+1,aV(bF,bE.line+1));var bI=bF.getRange(bE,bC);bI=bI.replace(/\n\s*/g," ");bF.replaceRange(bI,bE,bC)}var bG=c(bE.line,bA);bF.setCursor(bG);if(bB.visualMode){aR(bF)}},newLineAndEnterInsertMode:function(by,bz,bA){bA.insertMode=true;var bB=C(by.getCursor());if(bB.line===by.firstLine()&&!bz.after){by.replaceRange("\n",c(by.firstLine(),0));by.setCursor(by.firstLine(),0)}else{bB.line=(bz.after)?bB.line:bB.line-1;bB.ch=aV(by,bB.line);by.setCursor(bB);var bC=b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent;bC(by)}this.enterInsertMode(by,{repeat:bz.repeat},bA)},paste:function(bM,bL,bU){var bF=C(bM.getCursor());var bz=q.registerController.getRegister(bL.registerName);var bP=bz.toString();if(!bP){return}if(bL.matchIndent){var bR=bM.getOption("tabSize");var bG=function(b1){var b0=(b1.split("\t").length-1);var bZ=(b1.split(" ").length-1);return b0*bR+bZ*1};var bW=bM.getLine(bM.getCursor().line);var bO=bG(bW.match(/^\s*/)[0]);var by=bP.replace(/\n$/,"");var bD=bP!==by;var bJ=bG(bP.match(/^\s*/)[0]);var bP=by.replace(/^\s*/gm,function(bZ){var b0=bO+(bG(bZ)-bJ);if(b0<0){return""}else{if(bM.getOption("indentWithTabs")){var b1=Math.floor(b0/bR);return Array(b1+1).join("\t")}else{return Array(b0+1).join(" ")}}});bP+=bD?"\n":""}if(bL.repeat>1){var bP=Array(bL.repeat+1).join(bP)}var bI=bz.linewise;var bK=bz.blockwise;if(bI){if(bU.visualMode){bP=bU.visualLine?bP.slice(0,-1):"\n"+bP.slice(0,bP.length-1)+"\n"}else{if(bL.after){bP="\n"+bP.slice(0,bP.length-1);bF.ch=aV(bM,bF.line)}else{bF.ch=0}}}else{if(bK){bP=bP.split("\n");for(var bV=0;bV<bP.length;bV++){bP[bV]=(bP[bV]=="")?" ":bP[bV]}}bF.ch+=bL.after?1:0}var bC;var bQ;if(bU.visualMode){bU.lastPastedText=bP;var bB;var bY=a5(bM,bU);var bS=bY[0];var bA=bY[1];var bT=bM.getSelection();var bH=bM.listSelections();var bE=new Array(bH.length).join("1").split("1");if(bU.lastSelection){bB=bU.lastSelection.headMark.find()}q.registerController.unnamedRegister.setText(bT);if(bK){bM.replaceSelections(bE);bA=c(bS.line+bP.length-1,bS.ch);bM.setCursor(bS);F(bM,bA);bM.replaceSelections(bP);bC=bS}else{if(bU.visualBlock){bM.replaceSelections(bE);bM.setCursor(bS);bM.replaceRange(bP,bS,bS);bC=bS}else{bM.replaceRange(bP,bS,bA);bC=bM.posFromIndex(bM.indexFromPos(bS)+bP.length-1)}}if(bB){bU.lastSelection.headMark=bM.setBookmark(bB)}if(bI){bC.ch=0}}else{if(bK){bM.setCursor(bF);for(var bV=0;bV<bP.length;bV++){var bN=bF.line+bV;if(bN>bM.lastLine()){bM.replaceRange("\n",c(bN,0))}var bX=aV(bM,bN);if(bX<bF.ch){aW(bM,bN,bF.ch)}}bM.setCursor(bF);F(bM,c(bF.line+bP.length-1,bF.ch));bM.replaceSelections(bP);bC=bF}else{bM.replaceRange(bP,bF);if(bI&&bL.after){bC=c(bF.line+1,aZ(bM.getLine(bF.line+1)))}else{if(bI&&!bL.after){bC=c(bF.line,aZ(bM.getLine(bF.line)))}else{if(!bI&&bL.after){bQ=bM.indexFromPos(bF);bC=bM.posFromIndex(bQ+bP.length-1)}else{bQ=bM.indexFromPos(bF);bC=bM.posFromIndex(bQ+bP.length)}}}}}if(bU.visualMode){aR(bM)}bM.setCursor(bC)},undo:function(by,bz){by.operation(function(){aw(by,b.commands.undo,bz.repeat)();by.setCursor(by.getCursor("anchor"))})},redo:function(by,bz){aw(by,b.commands.redo,bz.repeat)()},setRegister:function(bA,by,bz){bz.inputState.registerName=by.selectedCharacter},setMark:function(by,bz,bA){var bB=bz.selectedCharacter;aP(by,bA,bB,by.getCursor())},replace:function(bG,bA,bC){var bB=bA.selectedCharacter;var bF=bG.getCursor();var bE;var bH;var bz=bG.listSelections();if(bC.visualMode){bF=bG.getCursor("start");bH=bG.getCursor("end")}else{var bI=bG.getLine(bF.line);bE=bF.ch+bA.repeat;if(bE>bI.length){bE=bI.length}bH=c(bF.line,bE)}if(bB=="\n"){if(!bC.visualMode){bG.replaceRange("",bF,bH)}(b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent)(bG)}else{var by=bG.getRange(bF,bH);by=by.replace(/[^\n]/g,bB);if(bC.visualBlock){var bD=new Array(bG.getOption("tabSize")+1).join(" ");by=bG.getSelection();by=by.replace(/\t/g,bD).replace(/[^\n]/g,bB).split("\n");bG.replaceSelections(by)}else{bG.replaceRange(by,bF,bH)}if(bC.visualMode){bF=aM(bz[0].anchor,bz[0].head)?bz[0].anchor:bz[0].head;bG.setCursor(bF);aR(bG)}else{bG.setCursor(D(bH,0,-1))}}},incrementNumberToken:function(bI,bz){var bJ=bI.getCursor();var bE=bI.getLine(bJ.line);var bL=/-?\d+/g;var bD;var by;var bC;var bK;var bA;while((bD=bL.exec(bE))!==null){bA=bD[0];by=bD.index;bC=by+bA.length;if(bJ.ch<bC){break}}if(!bz.backtrack&&(bC<=bJ.ch)){return}if(bA){var bH=bz.increase?1:-1;var bB=parseInt(bA)+(bH*bz.repeat);var bG=c(bJ.line,by);var bF=c(bJ.line,bC);bK=bB.toString();bI.replaceRange(bK,bG,bF)}else{return}bI.setCursor(c(bJ.line,by+bK.length-1))},repeatLastEdit:function(bz,bA,bB){var by=bB.lastEditInputState;if(!by){return}var bC=bA.repeat;if(bC&&bA.repeatIsExplicit){bB.lastEditInputState.repeatOverride=bC}else{bC=bB.lastEditInputState.repeatOverride||bC}x(bz,bB,bC,false)},exitInsertMode:v};function Z(bz,bD,bB){var bA=Math.min(Math.max(bz.firstLine(),bD.line),bz.lastLine());var by=aV(bz,bA)-1;by=(bB)?by+1:by;var bC=Math.min(Math.max(0,bD.ch),by);return c(bA,bC)}function bh(bz){var by={};for(var bA in bz){if(bz.hasOwnProperty(bA)){by[bA]=bz[bA]}}return by}function D(bz,by,bA){if(typeof by==="object"){bA=by.ch;by=by.line}return c(bz.line+by,bz.ch+bA)}function bd(by,bz){return{line:bz.line-by.line,ch:bz.line-by.line}}function bj(bG,bE,by,bC){var bB,bF=[],bD=[];for(var bA=0;bA<bE.length;bA++){var bz=bE[bA];if(by=="insert"&&bz.context!="insert"||bz.context&&bz.context!=by||bC.operator&&bz.type=="action"||!(bB=R(bG,bz.keys))){continue}if(bB=="partial"){bF.push(bz)}if(bB=="full"){bD.push(bz)}}return{partial:bF.length&&bF,full:bD.length&&bD}}function R(bB,by){if(by.slice(-11)=="<character>"){var bz=by.length-11;var bC=bB.slice(0,bz);var bA=by.slice(0,bz);return bC==bA&&bB.length>bz?"full":bA.indexOf(bC)==0?"partial":false}else{return bB==by?"full":by.indexOf(bB)==0?"partial":false}}function Q(bA){var bz=/^.*(<[\w\-]+>)$/.exec(bA);var by=bz?bz[1]:bA.slice(-1);if(by.length>1){switch(by){case"<CR>":by="\n";break;case"<Space>":by=" ";break;default:break}}return by}function aw(by,bz,bA){return function(){for(var bB=0;bB<bA;bB++){bz(by)}}}function C(by){return c(by.line,by.ch)}function bv(bz,by){return bz.ch==by.ch&&bz.line==by.line}function aM(bz,by){if(bz.line<by.line){return true}if(bz.line==by.line&&bz.ch<by.ch){return true}return false}function av(bz,by){if(arguments.length>2){by=av.apply(undefined,Array.prototype.slice.call(arguments,1))}return aM(bz,by)?bz:by}function a8(bz,by){if(arguments.length>2){by=a8.apply(undefined,Array.prototype.slice.call(arguments,1))}return aM(bz,by)?by:bz}function au(bB,bA,bz){var bC=aM(bB,bA);var by=aM(bA,bz);return bC&&by}function aV(by,bz){return by.getLine(bz).length}function k(by){return by.split("").reverse().join("")}function a7(by){if(by.trim){return by.trim()}return by.replace(/^\s+|\s+$/g,"")}function g(by){return by.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function aW(by,bC,bB){var bA=aV(by,bC);var bz=new Array(bB-bA+1).join(" ");by.setCursor(c(bC,bA));by.replaceRange(bz,by.getCursor())}function F(bG,bz){var bB=[],bA=bG.listSelections();var bC=C(bG.clipPos(bz));var bR=!bv(bz,bC);var bE=bG.getCursor("head");var bQ=u(bA,bE);var bH=bv(bA[bQ].head,bA[bQ].anchor);var bP=bA.length-1;var bF=bP-bQ>bQ?bP:0;var bD=bA[bF].anchor;var bM=Math.min(bD.line,bC.line);var by=Math.max(bD.line,bC.line);var bI=bD.ch,bJ=bC.ch;var bO=bA[bF].head.ch-bI;var bL=bJ-bI;if(bO>0&&bL<=0){bI++;if(!bR){bJ--}}else{if(bO<0&&bL>=0){bI--;if(!bH){bJ++}}else{if(bO<0&&bL==-1){bI--;bJ++}}}for(var bK=bM;bK<=by;bK++){var bN={anchor:new c(bK,bI),head:new c(bK,bJ)};bB.push(bN)}bQ=bC.line==by?bB.length-1:0;bG.setSelections(bB);bz.ch=bJ;bD.ch=bI;return bD}function aS(bz,bB,by){var bD=[];for(var bA=0;bA<by;bA++){var bC=D(bB,bA,0);bD.push({anchor:bC,head:bC})}bz.setSelections(bD,0)}function u(bz,bD,by){for(var bA=0;bA<bz.length;bA++){var bB=by!="head"&&bv(bz[bA].anchor,bD);var bC=by!="anchor"&&bv(bz[bA].head,bD);if(bB||bC){return bA}}return -1}function a5(bz,bB){var bA=bB.lastSelection;var by=function(){var bE=bz.listSelections();var bH=bE[0];var bD=bE[bE.length-1];var bF=aM(bH.anchor,bH.head)?bH.anchor:bH.head;var bG=aM(bD.anchor,bD.head)?bD.head:bD.anchor;return[bF,bG]};var bC=function(){var bN=bz.getCursor();var bO=bz.getCursor();var bI=bA.visualBlock;if(bI){var bF=bI.width;var bP=bI.height;bO=c(bN.line+bP,bN.ch+bF);var bG=[];for(var bJ=bN.line;bJ<bO.line;bJ++){var bK=c(bJ,bN.ch);var bM=c(bJ,bO.ch);var bL={anchor:bK,head:bM};bG.push(bL)}bz.setSelections(bG)}else{var bE=bA.anchorMark.find();var bH=bA.headMark.find();var bQ=bH.line-bE.line;var bD=bH.ch-bE.ch;bO={line:bO.line+bQ,ch:bQ?bO.ch:bD+bO.ch};if(bA.visualLine){bN=c(bN.line,0);bO=c(bO.line,aV(bz,bO.line))}bz.setSelection(bN,bO)}return[bN,bO]};if(!bB.visualMode){return bC()}else{return by()}}function bf(by,bz){var bA=bz.sel.anchor;var bB=bz.sel.head;if(bz.lastPastedText){bB=by.posFromIndex(by.indexFromPos(bA)+bz.lastPastedText.length);bz.lastPastedText=null}bz.lastSelection={anchorMark:by.setBookmark(bA),headMark:by.setBookmark(bB),anchor:C(bA),head:C(bB),visualMode:bz.visualMode,visualLine:bz.visualLine,visualBlock:bz.visualBlock}}function t(by,bE,bz){var bD=by.state.vim.sel;var bC=bD.head;var bA=bD.anchor;var bB;if(aM(bz,bE)){bB=bz;bz=bE;bE=bB}if(aM(bC,bA)){bC=av(bE,bC);bA=a8(bA,bz)}else{bA=av(bE,bA);bC=a8(bC,bz);bC=D(bC,0,-1);if(bC.ch==-1&&bC.line!=by.firstLine()){bC=c(bC.line-1,aV(by,bC.line-1))}}return[bA,bC]}function M(by,bB,bC){var bz=by.state.vim;bB=bB||bz.sel;var bC=bC||bz.visualLine?"line":bz.visualBlock?"block":"char";var bA=bx(by,bB,bC);by.setSelections(bA.ranges,bA.primary);ac(by)}function bx(bM,bB,bH,bA){var bJ=C(bB.head);var bG=C(bB.anchor);if(bH=="char"){var bK=!bA&&!aM(bB.head,bB.anchor)?1:0;var bC=aM(bB.head,bB.anchor)?1:0;bJ=D(bB.head,0,bK);bG=D(bB.anchor,0,bC);return{ranges:[{anchor:bG,head:bJ}],primary:0}}else{if(bH=="line"){if(!aM(bB.head,bB.anchor)){bG.ch=0;var bL=bM.lastLine();if(bJ.line>bL){bJ.line=bL}bJ.ch=aV(bM,bJ.line)}else{bJ.ch=0;bG.ch=aV(bM,bG.line)}return{ranges:[{anchor:bG,head:bJ}],primary:0}}else{if(bH=="block"){var bI=Math.min(bG.line,bJ.line),bE=Math.min(bG.ch,bJ.ch),by=Math.max(bG.line,bJ.line),bN=Math.max(bG.ch,bJ.ch)+1;var bO=by-bI+1;var bD=bJ.line==bI?0:bO-1;var bz=[];for(var bF=0;bF<bO;bF++){bz.push({anchor:c(bI+bF,bE),head:c(bI+bF,bN)})}return{ranges:bz,primary:bD}}}}}function e(by){var bz=by.getCursor("head");if(by.getSelection().length==1){bz=av(bz,by.getCursor("anchor"))}return bz}function aR(by,bA){var bz=by.state.vim;if(bA!==false){by.setCursor(Z(by,bz.sel.head))}bf(by,bz);bz.visualMode=false;bz.visualLine=false;bz.visualBlock=false;b.signal(by,"vim-mode-change",{mode:"normal"});if(bz.fakeCursor){bz.fakeCursor.clear()}}function al(bz,by,bD){var bC=bz.getRange(by,bD);if(/\n\s*$/.test(bC)){var bB=bC.split("\n");bB.pop();var bA;for(var bA=bB.pop();bB.length>0&&bA&&T(bA);bA=bB.pop()){bD.line--;bD.ch=0}if(bA){bD.line--;bD.ch=aV(bz,bD.line)}else{bD.ch=0}}}function bc(bz,by,bA){by.ch=0;bA.ch=0;bA.line++}function aZ(bz){if(!bz){return 0}var by=bz.search(/\S/);return by==-1?bz.length:by}function aD(bH,bD,bR,bz,bS){var bB=e(bH);var bK=bH.getLine(bB.line);var bN=bB.ch;var bM=bK.substring(bN);var bO;if(bS){bO=bM.search(/\w/)}else{bO=bM.search(/\S/)}if(bO==-1){return null}bN+=bO;bM=bK.substring(bN);var bQ=bK.substring(0,bN);var bT;if(bz){bT=/^\S+/}else{if((/\w/).test(bK.charAt(bN))){bT=/^\w+/}else{bT=/^[^\w\s]+/}}var bE=bT.exec(bM);var bL=bN;var bA=bN+bE[0].length;var bC=k(bQ);var bI=bT.exec(bC);if(bI){bL-=bI[0].length}if(bD){var bJ=bK.substring(bA);var by=bJ.match(/^\s*/)[0].length;if(by>0){bA+=by}else{var bG=bC.length-bL;var bF=bC.substring(bG);var bP=bF.match(/^\s*/)[0].length;bL-=bP}}return{start:c(bB.line,bL),end:c(bB.line,bA)}}function be(by,bz,bA){if(!bv(bz,bA)){q.jumpList.add(by,bz,bA)}}function aC(by,bz){q.lastChararacterSearch.increment=by;q.lastChararacterSearch.forward=bz.forward;q.lastChararacterSearch.selectedCharacter=bz.selectedCharacter}var S={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"};var aX={bracket:{isComplete:function(by){if(by.nextCh===by.symb){by.depth++;if(by.depth>=1){return true}}else{if(by.nextCh===by.reverseSymb){by.depth--}}return false}},section:{init:function(by){by.curMoveThrough=true;by.symb=(by.forward?"]":"[")===by.symb?"{":"}"},isComplete:function(by){return by.index===0&&by.nextCh===by.symb}},comment:{isComplete:function(bz){var by=bz.lastCh==="*"&&bz.nextCh==="/";bz.lastCh=bz.nextCh;return by}},method:{init:function(by){by.symb=(by.symb==="m"?"{":"}");by.reverseSymb=by.symb==="{"?"}":"{"},isComplete:function(by){if(by.nextCh===by.symb){return true}return false}},preprocess:{init:function(by){by.index=0},isComplete:function(bz){if(bz.nextCh==="#"){var by=bz.lineText.match(/#(\w+)/)[1];if(by==="endif"){if(bz.forward&&bz.depth===0){return true}bz.depth++}else{if(by==="if"){if(!bz.forward&&bz.depth===0){return true}bz.depth--}}if(by==="else"&&bz.depth===0){return true}}return false}}};function bq(bH,bz,bC,bA){var bK=C(bH.getCursor());var bI=bC?1:-1;var bB=bC?bH.lineCount():-1;var bG=bK.ch;var bM=bK.line;var bF=bH.getLine(bM);var by={lineText:bF,nextCh:bF.charAt(bG),lastCh:null,index:bG,symb:bA,reverseSymb:(bC?{")":"(","}":"{"}:{"(":")","{":"}"})[bA],forward:bC,depth:0,curMoveThrough:false};var bD=S[bA];if(!bD){return bK}var bL=aX[bD].init;var bJ=aX[bD].isComplete;if(bL){bL(by)}while(bM!==bB&&bz){by.index+=bI;by.nextCh=by.lineText.charAt(by.index);if(!by.nextCh){bM+=bI;by.lineText=bH.getLine(bM)||"";if(bI>0){by.index=0}else{var bE=by.lineText.length;by.index=(bE>0)?(bE-1):0}by.nextCh=by.lineText.charAt(by.index)}if(bJ(by)){bK.line=bM;bK.ch=by.index;bz--}}if(by.nextCh||by.curMoveThrough){return c(bM,by.index)}return bK}function bs(bI,bJ,bB,bG,bH){var bC=bJ.line;var bF=bJ.ch;var bM=bI.getLine(bC);var bz=bB?1:-1;var bD=bG?bl:aq;if(bH&&bM==""){bC+=bz;bM=bI.getLine(bC);if(!f(bI,bC)){return null}bF=(bB)?0:bM.length}while(true){if(bH&&bM==""){return{from:0,to:0,line:bC}}var bE=(bz>0)?bM.length:-1;var bL=bE,bK=bE;while(bF!=bE){var by=false;for(var bA=0;bA<bD.length&&!by;++bA){if(bD[bA].test(bM.charAt(bF))){bL=bF;while(bF!=bE&&bD[bA].test(bM.charAt(bF))){bF+=bz}bK=bF;by=bL!=bK;if(bL==bJ.ch&&bC==bJ.line&&bK==bL+bz){continue}else{return{from:Math.min(bL,bK+1),to:Math.max(bL,bK),line:bC}}}}if(!by){bF+=bz}}bC+=bz;if(!f(bI,bC)){return null}bM=bI.getLine(bC);bF=(bz>0)?0:bM.length}throw new Error("The impossible happened.")}function aB(bI,bK,bz,bD,bM,bG){var bE=C(bK);var bF=[];if(bD&&!bM||!bD&&bM){bz++}var bH=!(bD&&bM);for(var bB=0;bB<bz;bB++){var by=bs(bI,bK,bD,bG,bH);if(!by){var bA=aV(bI,bI.lastLine());bF.push(bD?{line:bI.lastLine(),from:bA,to:bA}:{line:0,from:0,to:0});break}bF.push(by);bK=c(by.line,bD?(by.to-1):by.from)}var bC=bF.length!=bz;var bJ=bF[0];var bL=bF.pop();if(bD&&!bM){if(!bC&&(bJ.from!=bE.ch||bJ.line!=bE.line)){bL=bF.pop()}return c(bL.line,bL.from)}else{if(bD&&bM){return c(bL.line,bL.to-1)}else{if(!bD&&bM){if(!bC&&(bJ.to!=bE.ch||bJ.line!=bE.line)){bL=bF.pop()}return c(bL.line,bL.to)}else{return c(bL.line,bL.from)}}}}function bp(bD,bz,bB,bC){var bF=bD.getCursor();var by=bF.ch;var bE;for(var bA=0;bA<bz;bA++){var bG=bD.getLine(bF.line);bE=a9(by,bG,bC,bB,true);if(bE==-1){return null}by=bE}return c(bD.getCursor().line,bE)}function aj(by,bA){var bz=by.getCursor().line;return Z(by,c(bz,bA-1))}function aP(by,bz,bA,bB){if(!J(bA,aE)){return}if(bz.marks[bA]){bz.marks[bA].clear()}bz.marks[bA]=by.setBookmark(bB)}function a9(bD,bz,bC,bA,bB){var by;if(bA){by=bz.indexOf(bC,bD+1);if(by!=-1&&!bB){by-=1}}else{by=bz.lastIndexOf(bC,bD-1);if(by!=-1&&!bB){by+=1}}return by}function bm(bM,bJ,bz,bA,bL){var bN=bJ.line;var bE=bM.firstLine();var bK=bM.lastLine();var by,bB,bH=bN;function bG(bO){return !bM.getLine(bO)}function bI(bP,bO,bQ){if(bQ){return bG(bP)!=bG(bP+bO)}return !bG(bP)&&bG(bP+bO)}if(bA){while(bE<=bH&&bH<=bK&&bz>0){if(bI(bH,bA)){bz--}bH+=bA}return new c(bH,0)}var bD=bM.state.vim;if(bD.visualLine&&bI(bN,1,true)){var bF=bD.sel.anchor;if(bI(bF.line,-1,true)){if(!bL||bF.line!=bN){bN+=1}}}var bC=bG(bN);for(bH=bN;bH<=bK&&bz;bH++){if(bI(bH,1,true)){if(!bL||bG(bH)!=bC){bz--}}}bB=new c(bH,0);if(bH>bK&&!bC){bC=true}else{bL=false}for(bH=bN;bH>bE;bH--){if(!bL||bG(bH)==bC||bH==bN){if(bI(bH,-1,true)){break}}}by=new c(bH,0);return{start:by,end:bB}}function n(bI,bG,bA,bH){var bJ=bG,bz,bC;var bF=({"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/})[bA];var bB=({"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"})[bA];var by=bI.getLine(bJ.line).charAt(bJ.ch);var bD=by===bB?1:0;bz=bI.scanForBracket(c(bJ.line,bJ.ch+bD),-1,null,{bracketRegex:bF});bC=bI.scanForBracket(c(bJ.line,bJ.ch+bD),1,null,{bracketRegex:bF});if(!bz||!bC){return{start:bJ,end:bJ}}bz=bz.pos;bC=bC.pos;if((bz.line==bC.line&&bz.ch>bC.ch)||(bz.line>bC.line)){var bE=bz;bz=bC;bC=bE}if(bH){bC.ch+=1}else{bz.ch+=1}return{start:bz,end:bC}}function aO(bH,bF,bA,bG){var bI=C(bF);var bJ=bH.getLine(bI.line);var bE=bJ.split("");var bz,bB,bC,bD;var by=bE.indexOf(bA);if(bI.ch<by){bI.ch=by}else{if(by<bI.ch&&bE[bI.ch]==bA){bB=bI.ch;--bI.ch}}if(bE[bI.ch]==bA&&!bB){bz=bI.ch+1}else{for(bC=bI.ch;bC>-1&&!bz;bC--){if(bE[bC]==bA){bz=bC+1}}}if(bz&&!bB){for(bC=bz,bD=bE.length;bC<bD&&!bB;bC++){if(bE[bC]==bA){bB=bC}}}if(!bz||!bB){return{start:bI,end:bI}}if(bG){--bz;++bB}return{start:c(bI.line,bz),end:c(bI.line,bB)}}aJ("pcre",true,"boolean");function ad(){}ad.prototype={getQuery:function(){return q.query},setQuery:function(by){q.query=by},getOverlay:function(){return this.searchOverlay},setOverlay:function(by){this.searchOverlay=by},isReversed:function(){return q.isReversed},setReversed:function(by){q.isReversed=by},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(by){this.annotate=by}};function aG(by){var bz=by.state.vim;return bz.searchState_||(bz.searchState_=new ad())}function ab(by,bB,bC,bz,bA){if(by.openDialog){by.openDialog(bB,bz,{bottom:true,value:bA.value,onKeyDown:bA.onKeyDown,onKeyUp:bA.onKeyUp})}else{bz(prompt(bC,""))}}function w(bA){var bz=ak(bA)||[];if(!bz.length){return[]}var bB=[];if(bz[0]!==0){return}for(var by=0;by<bz.length;by++){if(typeof bz[by]=="number"){bB.push(bA.substring(bz[by]+1,bz[by+1]))}}return bB}function ak(bB){var bz=false;var bA=[];for(var by=0;by<bB.length;by++){var bC=bB.charAt(by);if(!bz&&bC=="/"){bA.push(by)}bz=!bz&&(bC=="\\")}return bA}function bo(bF){var bG="|(){";var bC="}";var bD=false;var bz=[];for(var bA=-1;bA<bF.length;bA++){var bE=bF.charAt(bA)||"";var by=bF.charAt(bA+1)||"";var bB=(by&&bG.indexOf(by)!=-1);if(bD){if(bE!=="\\"||!bB){bz.push(bE)}bD=false}else{if(bE==="\\"){bD=true;if(by&&bC.indexOf(by)!=-1){bB=true}if(!bB||by==="\\"){bz.push(bE)}}else{bz.push(bE);if(bB&&by!=="\\"){bz.push("\\")}}}}return bz.join("")}function br(bB){var bA=false;var by=[];for(var bz=-1;bz<bB.length;bz++){var bD=bB.charAt(bz)||"";var bC=bB.charAt(bz+1)||"";if(bA){by.push(bD);bA=false}else{if(bD==="\\"){bA=true;if((ag(bC)||bC==="$")){by.push("$")}else{if(bC!=="/"&&bC!=="\\"){by.push("\\")}}}else{if(bD==="$"){by.push("$")}by.push(bD);if(bC==="/"){by.push("\\")}}}}return by.join("")}function af(bA){var bz=new b.StringStream(bA);var by=[];while(!bz.eol()){while(bz.peek()&&bz.peek()!="\\"){by.push(bz.next())}if(bz.match("\\/",true)){by.push("/")}else{if(bz.match("\\\\",true)){by.push("\\")}else{by.push(bz.next())}}}return by.join("")}function ay(bC,bA,bF){var bE=q.registerController.getRegister("/");bE.setText(bC);if(bC instanceof RegExp){return bC}var bD=ak(bC);var bG;var bz;if(!bD.length){bG=bC}else{bG=bC.substring(0,bD[0]);var by=bC.substring(bD[0]);bz=(by.indexOf("i")!=-1)}if(!bG){return null}if(!o("pcre")){bG=bo(bG)}if(bF){bA=(/^[^A-Z]*$/).test(bG)}var bB=new RegExp(bG,(bA||bz)?"i":undefined);return bB}function bk(by,bz){if(by.openNotification){by.openNotification('<span style="color: red">'+bz+"</span>",{bottom:true,duration:5000})}else{alert(bz)}}function aF(bz,bA){var by="";if(bz){by+='<span style="font-family: monospace">'+bz+"</span>"}by+='<input type="text"/> <span style="color: #888">';if(bA){by+='<span style="color: #888">';by+=bA;by+="</span>"}return by}var P="(Javascript regexp)";function a0(bz,bA){var bB=(bA.prefix||"")+" "+(bA.desc||"");var by=aF(bA.prefix,bA.desc);ab(bz,by,bB,bA.onClose,bA)}function X(bz,by){if(bz instanceof RegExp&&by instanceof RegExp){var bB=["global","multiline","ignoreCase","source"];for(var bA=0;bA<bB.length;bA++){var bC=bB[bA];if(bz[bC]!==by[bC]){return false}}return true}return false}function bu(by,bD,bz,bA){if(!bD){return}var bC=aG(by);var bB=ay(bD,!!bz,!!bA);if(!bB){return}aI(by,bB);if(X(bB,bC.getQuery())){return bB}bC.setQuery(bB);return bB}function aL(bz){if(bz.source.charAt(0)=="^"){var by=true}return{token:function(bB){if(by&&!bB.sol()){bB.skipToEnd();return}var bA=bB.match(bz,false);if(bA){if(bA[0].length==0){bB.next();return"searching"}if(!bB.sol()){bB.backUp(1);if(!bz.exec(bB.next()+bA[0])){bB.next();return null}}bB.match(bz);return"searching"}while(!bB.eol()){bB.next();if(bB.match(bz,false)){break}}},query:bz}}function aI(by,bB){var bA=aG(by);var bz=bA.getOverlay();if(!bz||bB!=bz.query){if(bz){by.removeOverlay(bz)}bz=aL(bB);by.addOverlay(bz);if(by.showMatchesOnScrollbar){if(bA.getScrollbarAnnotate()){bA.getScrollbarAnnotate().clear()}bA.setScrollbarAnnotate(by.showMatchesOnScrollbar(bB))}bA.setOverlay(bz)}}function bw(by,bz,bB,bA){if(bA===undefined){bA=1}return by.operation(function(){var bF=by.getCursor();var bE=by.getSearchCursor(bB,bF);for(var bC=0;bC<bA;bC++){var bD=bE.find(bz);if(bC==0&&bD&&bv(bE.from(),bF)){bD=bE.find(bz)}if(!bD){bE=by.getSearchCursor(bB,(bz)?c(by.lastLine()):c(by.firstLine(),0));if(!bE.find(bz)){return}}}return bE.from()})}function aK(by){var bz=aG(by);by.removeOverlay(aG(by).getOverlay());bz.setOverlay(null);if(bz.getScrollbarAnnotate()){bz.getScrollbarAnnotate().clear();bz.setScrollbarAnnotate(null)}}function ae(bA,bz,by){if(typeof bA!="number"){bA=bA.line}if(bz instanceof Array){return J(bA,bz)}else{if(by){return(bA>=bz&&bA<=by)}else{return bA==bz}}}function bb(by){var bB=by.getScrollInfo();var bA=6;var bE=10;var bD=by.coordsChar({left:0,top:bA+bB.top},"local");var bz=bB.clientHeight-bE+bB.top;var bC=by.coordsChar({left:0,top:bz},"local");return{top:bD.line,bottom:bC.line}}var B=[{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"set"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:true},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:true},{name:"global",shortName:"g"}];var Y=function(){this.buildCommandMap_()};Y.prototype={processCommand:function(bJ,bI,bz){var bD=bJ.state.vim;var bA=q.registerController.getRegister(":");var bG=bA.toString();if(bD.visualMode){aR(bJ)}var by=new b.StringStream(bI);bA.setText(bI);var bC=bz||{};bC.input=bI;try{this.parseInput_(bJ,by,bC)}catch(bH){bk(bJ,bH);throw bH}var bB;var bF;if(!bC.commandName){if(bC.line!==undefined){bF="move"}}else{bB=this.matchCommand_(bC.commandName);if(bB){bF=bB.name;if(bB.excludeFromCommandHistory){bA.setText(bG)}this.parseCommandArgs_(by,bC,bB);if(bB.type=="exToKey"){for(var bE=0;bE<bB.toKeys.length;bE++){b.Vim.handleKey(bJ,bB.toKeys[bE],"mapping")}return}else{if(bB.type=="exToEx"){this.processCommand(bJ,bB.toInput);return}}}}if(!bF){bk(bJ,'Not an editor command ":'+bI+'"');return}try{a4[bF](bJ,bC);if((!bB||!bB.possiblyAsync)&&bC.callback){bC.callback()}}catch(bH){bk(bJ,bH);throw bH}},parseInput_:function(bz,bA,by){bA.eatWhile(":");if(bA.eat("%")){by.line=bz.firstLine();by.lineEnd=bz.lastLine()}else{by.line=this.parseLineSpec_(bz,bA);if(by.line!==undefined&&bA.eat(",")){by.lineEnd=this.parseLineSpec_(bz,bA)}}var bB=bA.match(/^(\w+)/);if(bB){by.commandName=bB[1]}else{by.commandName=bA.match(/.*/)[0]}return by},parseLineSpec_:function(by,bz){var bA=bz.match(/^(\d+)/);if(bA){return parseInt(bA[1],10)-1}switch(bz.next()){case".":return by.getCursor().line;case"$":return by.lastLine();case"'":var bB=by.state.vim.marks[bz.next()];if(bB&&bB.find()){return bB.find().line}throw new Error("Mark not set");default:bz.backUp(1);return undefined}},parseCommandArgs_:function(bz,bC,bB){if(bz.eol()){return}bC.argString=bz.match(/.*/)[0];var bA=bB.argDelimiter||/\s+/;var by=a7(bC.argString).split(bA);if(by.length&&by[0]){bC.args=by}},matchCommand_:function(bz){for(var by=bz.length;by>0;by--){var bA=bz.substring(0,by);if(this.commandMap_[bA]){var bB=this.commandMap_[bA];if(bB.name.indexOf(bz)===0){return bB}}}return null},buildCommandMap_:function(){this.commandMap_={};for(var bz=0;bz<B.length;bz++){var bA=B[bz];var by=bA.shortName||bA.name;this.commandMap_[by]=bA}},map:function(bz,bC,by){if(bz!=":"&&bz.charAt(0)==":"){if(by){throw Error("Mode not supported for ex mappings")}var bB=bz.substring(1);if(bC!=":"&&bC.charAt(0)==":"){this.commandMap_[bB]={name:bB,type:"exToEx",toInput:bC.substring(1),user:true}}else{this.commandMap_[bB]={name:bB,type:"exToKey",toKeys:bC,user:true}}}else{if(bC!=":"&&bC.charAt(0)==":"){var bA={keys:bz,type:"keyToEx",exArgs:{input:bC.substring(1)},user:true};if(by){bA.context=by}a.unshift(bA)}else{var bA={keys:bz,type:"keyToKey",toKeys:bC,user:true};if(by){bA.context=by}a.unshift(bA)}}},unmap:function(bz,by){if(bz!=":"&&bz.charAt(0)==":"){if(by){throw Error("Mode not supported for ex mappings")}var bB=bz.substring(1);if(this.commandMap_[bB]&&this.commandMap_[bB].user){delete this.commandMap_[bB];return}}else{var bC=bz;for(var bA=0;bA<a.length;bA++){if(bC==a[bA].keys&&a[bA].context===by&&a[bA].user){a.splice(bA,1);return}}}throw Error("No such mapping.")}};var a4={map:function(by,bB,bz){var bA=bB.args;if(!bA||bA.length<2){if(by){bk(by,"Invalid mapping: "+bB.input)}return}m.map(bA[0],bA[1],bz)},imap:function(by,bz){this.map(by,bz,"insert")},nmap:function(by,bz){this.map(by,bz,"normal")},vmap:function(by,bz){this.map(by,bz,"visual")},unmap:function(by,bB,bz){var bA=bB.args;if(!bA||bA.length<1){if(by){bk(by,"No such mapping: "+bB.input)}return}m.unmap(bA[0],bz)},move:function(by,bz){ba.processCommand(by,by.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true},repeatOverride:bz.line+1})},set:function(bG,bD){var bA=bD.args;if(!bA||bA.length<1){if(bG){bk(bG,"Invalid mapping: "+bD.input)}return}var bE=bA[0].split("=");var bz=bE[0];var bF=bE[1];var bC=false;if(bz.charAt(bz.length-1)=="?"){if(bF){throw Error("Trailing characters: "+bD.argString)}bz=bz.substring(0,bz.length-1);bC=true}if(bF===undefined&&bz.substring(0,2)=="no"){bz=bz.substring(2);bF=false}var bB=at[bz]&&at[bz].type=="boolean";if(bB&&bF==undefined){bF=true}if(!bB&&!bF||bC){var by=o(bz);if(by===true||by===false){bk(bG," "+(by?"":"no")+bz)}else{bk(bG,"  "+bz+"="+by)}}else{aH(bz,bF)}},registers:function(bD,bz){var bF=bz.args;var bC=q.registerController.registers;var bA="----------Registers----------<br><br>";if(!bF){for(var by in bC){var bG=bC[by].toString();if(bG.length){bA+='"'+by+"    "+bG+"<br>"}}}else{var by;bF=bF.join("");for(var bB=0;bB<bF.length;bB++){by=bF.charAt(bB);if(!q.registerController.isValidRegister(by)){continue}var bE=bC[by]||new bn();bA+='"'+by+"    "+bE.toString()+"<br>"}}bk(bD,bA)},sort:function(bH,bR){var bI,bB,bz,bA;function bC(){if(bR.argString){var bV=new b.StringStream(bR.argString);if(bV.eat("!")){bI=true}if(bV.eol()){return}if(!bV.eatSpace()){return"Invalid arguments"}var bX=bV.match(/[a-z]+/);if(bX){bX=bX[0];bB=bX.indexOf("i")!=-1;bz=bX.indexOf("u")!=-1;var bU=bX.indexOf("d")!=-1&&1;var bW=bX.indexOf("x")!=-1&&1;var bT=bX.indexOf("o")!=-1&&1;if(bU+bW+bT>1){return"Invalid arguments"}bA=bU&&"decimal"||bW&&"hex"||bT&&"octal"}if(bV.eatSpace()&&bV.match(/\/.*\//)){"patterns not supported"}}}var bD=bC();if(bD){bk(bH,bD+": "+bR.argString);return}var bM=bR.line||bH.firstLine();var bQ=bR.lineEnd||bR.line||bH.lastLine();if(bM==bQ){return}var bG=c(bM,0);var bO=c(bQ,aV(bH,bQ));var bL=bH.getRange(bG,bO).split("\n");var bE=(bA=="decimal")?/(-?)([\d]+)/:(bA=="hex")?/(-?)(?:0x)?([0-9a-f]+)/i:(bA=="octal")?/([0-7]+)/:null;var bF=(bA=="decimal")?10:(bA=="hex")?16:(bA=="octal")?8:null;var bJ=[],bN=[];if(bA){for(var bP=0;bP<bL.length;bP++){if(bE.exec(bL[bP])){bJ.push(bL[bP])}else{bN.push(bL[bP])}}}else{bN=bL}function bS(bU,bT){if(bI){var bV;bV=bU;bU=bT;bT=bV}if(bB){bU=bU.toLowerCase();bT=bT.toLowerCase()}var bX=bA&&bE.exec(bU);var bW=bA&&bE.exec(bT);if(!bX){return bU<bT?-1:1}bX=parseInt((bX[1]+bX[2]).toLowerCase(),bF);bW=parseInt((bW[1]+bW[2]).toLowerCase(),bF);return bX-bW}bJ.sort(bS);bN.sort(bS);bL=(!bI)?bN.concat(bJ):bJ.concat(bN);if(bz){var bK=bL;var by;bL=[];for(var bP=0;bP<bK.length;bP++){if(bK[bP]!=by){bL.push(bK[bP])}by=bK[bP]}}bH.replaceRange(bL.join("\n"),bG,bO)},global:function(bL,bC){var bz=bC.argString;if(!bz){bk(bL,"Regular Expression missing from global");return}var bF=(bC.line!==undefined)?bC.line:bL.firstLine();var bD=bC.lineEnd||bC.line||bL.lastLine();var bK=w(bz);var bN=bz,bB;if(bK.length){bN=bK[0];bB=bK.slice(1,bK.length).join("/")}if(bN){try{bu(bL,bN,true,true)}catch(bI){bk(bL,"Invalid regex: "+bN);return}}var bJ=aG(bL).getQuery();var by=[],bH="";for(var bE=bF;bE<=bD;bE++){var bA=bJ.test(bL.getLine(bE));if(bA){by.push(bE+1);bH+=bL.getLine(bE)+"<br>"}}if(!bB){bk(bL,bH);return}var bG=0;var bM=function(){if(bG<by.length){var bO=by[bG]+bB;m.processCommand(bL,bO,{callback:bM})}bG++};bM()},substitute:function(bF,bN){if(!bF.getSearchCursor){throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.")}var bO=bN.argString;var bI=bO?w(bO):[];var bG,bH="",by,bz,bD;var bE=false;var bK=false;if(bI.length){bG=bI[0];bH=bI[1];if(bH!==undefined){if(o("pcre")){bH=af(bH)}else{bH=br(bH)}q.lastSubstituteReplacePart=bH}by=bI[2]?bI[2].split(" "):[]}else{if(bO&&bO.length){bk(bF,"Substitutions should be of the form :s/pattern/replace/");return}}if(by){bz=by[0];bD=parseInt(by[1]);if(bz){if(bz.indexOf("c")!=-1){bE=true;bz.replace("c","")}if(bz.indexOf("g")!=-1){bK=true;bz.replace("g","")}bG=bG+"/"+bz}}if(bG){try{bu(bF,bG,true,true)}catch(bM){bk(bF,"Invalid regex: "+bG);return}}bH=bH||q.lastSubstituteReplacePart;if(bH===undefined){bk(bF,"No previous substitute regular expression");return}var bB=aG(bF);var bC=bB.getQuery();var bJ=(bN.line!==undefined)?bN.line:bF.getCursor().line;var bL=bN.lineEnd||bJ;if(bD){bJ=bL;bL=bJ+bD-1}var bP=Z(bF,c(bJ,0));var bA=bF.getSearchCursor(bC,bP);a6(bF,bE,bK,bJ,bL,bA,bC,bH,bN.callback)},redo:b.commands.redo,undo:b.commands.undo,write:function(by){if(b.commands.save){b.commands.save(by)}else{by.save()}},nohlsearch:function(by){aK(by)},delmarks:function(bI,bD){if(!bD.argString||!a7(bD.argString)){bk(bI,"Argument required");return}var by=bI.state.vim;var bJ=new b.StringStream(a7(bD.argString));while(!bJ.eol()){bJ.eatSpace();var bG=bJ.pos;if(!bJ.match(/[a-zA-Z]/,false)){bk(bI,"Invalid argument: "+bD.argString.substring(bG));return}var bA=bJ.next();if(bJ.match("-",true)){if(!bJ.match(/[a-zA-Z]/,false)){bk(bI,"Invalid argument: "+bD.argString.substring(bG));return}var bB=bA;var bF=bJ.next();if(E(bB)&&E(bF)||A(bB)&&A(bF)){var bz=bB.charCodeAt(0);var bH=bF.charCodeAt(0);if(bz>=bH){bk(bI,"Invalid argument: "+bD.argString.substring(bG));return}for(var bE=0;bE<=bH-bz;bE++){var bC=String.fromCharCode(bz+bE);delete by.marks[bC]}}else{bk(bI,"Invalid argument: "+bB+"-");return}}else{delete by.marks[bA]}}}};var m=new Y();function a6(bM,bz,bB,bH,bF,bA,bJ,bD,bN){bM.state.vim.exMode=true;var bE=false;var bL=bA.from();function bI(){bM.operation(function(){while(!bE){bC();bG()}bK()})}function bC(){var bP=bM.getRange(bA.from(),bA.to());var bO=bP.replace(bJ,bD);bA.replace(bO)}function bG(){var bO;while(bO=bA.findNext()&&ae(bA.from(),bH,bF)){if(!bB&&bL&&bA.from().line==bL.line){continue}bM.scrollIntoView(bA.from(),30);bM.setSelection(bA.from(),bA.to());bL=bA.from();bE=false;return}bE=true}function bK(bP){if(bP){bP()}bM.focus();if(bL){bM.setCursor(bL);var bO=bM.state.vim;bO.exMode=false;bO.lastHPos=bO.lastHSPos=bL.ch}if(bN){bN()}}function by(bR,bO,bS){b.e_stop(bR);var bP=b.keyName(bR);switch(bP){case"Y":bC();bG();break;case"N":bG();break;case"A":var bQ=bN;bN=undefined;bM.operation(bI);bN=bQ;break;case"L":bC();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":bK(bS);break}if(bE){bK(bS)}return true}bG();if(bE){bk(bM,"No matches for "+bJ.source);return}if(!bz){bI();if(bN){bN()}return}a0(bM,{prefix:"replace with <strong>"+bD+"</strong> (y/n/a/q/l)",onKeyDown:by})}b.keyMap.vim={attach:s,detach:h,call:a2};function v(bG){var bz=bG.state.vim;var bB=q.macroModeState;var bE=q.registerController.getRegister(".");var by=bB.isPlaying;var bC=bB.lastInsertModeChanges;var bH=[];if(!by){var bD=bC.inVisualBlock?bz.lastSelection.visualBlock.height:1;var bF=bC.changes;var bH=[];var bA=0;while(bA<bF.length){bH.push(bF[bA]);if(bF[bA] instanceof bi){bA++}else{bA+=bD}}bC.changes=bH;bG.off("change",bg);b.off(bG.getInputField(),"keydown",W)}if(!by&&bz.insertModeRepeat>1){x(bG,bz,bz.insertModeRepeat-1,true);bz.lastEditInputState.repeatOverride=bz.insertModeRepeat}delete bz.insertModeRepeat;bz.insertMode=false;bG.setCursor(bG.getCursor().line,bG.getCursor().ch-1);bG.setOption("keyMap","vim");bG.setOption("disableInput",true);bG.toggleOverwrite(false);bE.setText(bC.changes.join(""));b.signal(bG,"vim-mode-change",{mode:"normal"});if(bB.isRecording){an(bB)}}aJ("insertModeEscKeysTimeout",200,"number");b.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(by){var bz=b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent;bz(by)},fallthrough:["default"],attach:s,detach:h,call:a2};b.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:s,detach:h,call:a2};function H(bG,bA,bB,by){var bI=q.registerController.getRegister(by);var bz=bI.keyBuffer;var bE=0;bB.isPlaying=true;bB.replaySearchQueries=bI.searchQueries.slice(0);for(var bC=0;bC<bz.length;bC++){var bJ=bz[bC];var bD,bH;while(bJ){bD=(/<\w+-.+?>|<\w+>|./).exec(bJ);bH=bD[0];bJ=bJ.substring(bD.index+bH.length);b.Vim.handleKey(bG,bH,"macro");if(bA.insertMode){var bF=bI.insertModeChanges[bE++].changes;q.macroModeState.lastInsertModeChanges.changes=bF;ar(bG,bF,1);v(bG)}}}bB.isPlaying=false}function I(bB,by){if(bB.isPlaying){return}var bA=bB.latestRegister;var bz=q.registerController.getRegister(bA);if(bz){bz.pushText(by)}}function an(bA){if(bA.isPlaying){return}var bz=bA.latestRegister;var by=q.registerController.getRegister(bz);if(by){by.pushInsertModeChanges(bA.lastInsertModeChanges)}}function O(bB,bA){if(bB.isPlaying){return}var bz=bB.latestRegister;var by=q.registerController.getRegister(bz);if(by){by.pushSearchQuery(bA)}}function bg(bz,by){var bB=q.macroModeState;var bA=bB.lastInsertModeChanges;if(!bB.isPlaying){while(by){bA.expectCursorActivityForChange=true;if(by.origin=="+input"||by.origin=="paste"||by.origin===undefined){var bC=by.text.join("\n");bA.changes.push(bC)}by=by.next}}}function aa(by){var bz=by.state.vim;if(bz.insertMode){var bB=q.macroModeState;if(bB.isPlaying){return}var bA=bB.lastInsertModeChanges;if(bA.expectCursorActivityForChange){bA.expectCursorActivityForChange=false}else{bA.changes=[]}}else{if(!by.curOp.isVimOp){r(by,bz)}}if(bz.visualMode){ac(by)}}function ac(by){var bz=by.state.vim;var bB=C(bz.sel.head);var bA=D(bB,0,1);if(bz.fakeCursor){bz.fakeCursor.clear()}bz.fakeCursor=by.markText(bB,bA,{className:"cm-animate-fat-cursor"})}function r(by,bz){var bA=by.getCursor("anchor");var bB=by.getCursor("head");if(bz.visualMode&&bv(bB,bA)&&aV(by,bB.line)>bB.ch){aR(by,false)}else{if(!bz.visualMode&&!bz.insertMode&&by.somethingSelected()){bz.visualMode=true;bz.visualLine=false;b.signal(by,"vim-mode-change",{mode:"visual"})}}if(bz.visualMode){var bC=!aM(bB,bA)?-1:0;var bD=aM(bB,bA)?-1:0;bB=D(bB,0,bC);bA=D(bA,0,bD);bz.sel={anchor:bA,head:bB};aP(by,bz,"<",av(bB,bA));aP(by,bz,">",a8(bB,bA))}else{if(!bz.insertMode){bz.lastHPos=by.getCursor().ch}}}function bi(by){this.keyName=by}function W(bC){var bB=q.macroModeState;var bA=bB.lastInsertModeChanges;var bz=b.keyName(bC);if(!bz){return}function by(){bA.changes.push(new bi(bz));return true}if(bz.indexOf("Delete")!=-1||bz.indexOf("Backspace")!=-1){b.lookupKey(bz,"vim-insert",by)}}function x(bG,bB,bz,by){var bD=q.macroModeState;bD.isPlaying=true;var bH=!!bB.lastEditActionCommand;var bE=bB.inputState;function bA(){if(bH){ba.processAction(bG,bB,bB.lastEditActionCommand)}else{ba.evalInput(bG,bB)}}function bF(bJ){if(bD.lastInsertModeChanges.changes.length>0){bJ=!bB.lastEditActionCommand?1:bJ;var bI=bD.lastInsertModeChanges;ar(bG,bI.changes,bJ)}}bB.inputState=bB.lastEditInputState;if(bH&&bB.lastEditActionCommand.interlaceInsertRepeat){for(var bC=0;bC<bz;bC++){bA();bF(1)}}else{if(!by){bA()}bF(bz)}bB.inputState=bE;if(bB.insertMode&&!by){v(bG)}bD.isPlaying=false}function ar(bJ,bI,bz){function bF(bL){if(typeof bL=="string"){b.commands[bL](bJ)}else{bL(bJ)}return true}var bH=bJ.getCursor("head");var by=q.macroModeState.lastInsertModeChanges.inVisualBlock;if(by){var bD=bJ.state.vim;var bA=bD.lastSelection;var bC=bd(bA.anchor,bA.head);aS(bJ,bH,bC.line+1);bz=bJ.listSelections().length;bJ.setCursor(bH)}for(var bE=0;bE<bz;bE++){if(by){bJ.setCursor(D(bH,bE,0))}for(var bB=0;bB<bI.length;bB++){var bG=bI[bB];if(bG instanceof bi){b.lookupKey(bG.keyName,"vim-insert",bF)}else{var bK=bJ.getCursor();bJ.replaceRange(bG,bK,bK)}}}if(by){bJ.setCursor(D(bH,0,1))}}z();return aN};b.Vim=d()});